# 二次体の整数環
# 平方剰余

---

User
二次体の整数環について、どうなるか？証明してほしい！！
ChatGPT
いい質問！二次体 \(K=\mathbb{Q}(\sqrt{m})\)（ここで \(m\) は平方因子のない整数：**squarefree**）の整数環 \(\mathcal{O}_K\) がどうなるかを、はっきりした場合分けと証明を付けて示します。

# 結論（定理）
\(m\) を平方因子のない整数とする。すると
- \(m\equiv 2,3\pmod 4\) のとき \(\displaystyle \mathcal{O}_K=\mathbb{Z}[\sqrt{m}]\).
- \(m\equiv 1\pmod 4\) のとき \(\displaystyle \mathcal{O}_K=\mathbb{Z}\!\left[\frac{1+\sqrt{m}}{2}\right]\).

さらに判別式（体判別式）\(\Delta_K\) は
\[
\Delta_K=\begin{cases}
4m,& m\equiv 2,3\pmod4,\\[4pt]
m,& m\equiv 1\pmod4.
\end{cases}
\]

以下、証明を示します。

---

# 証明
任意の元 \(\alpha\in K\) は有理数係数で
\[
\alpha = a + b\sqrt{m}\quad (a,b\in\mathbb{Q})
\]
と表せる。\(\alpha\) が代数的整数であることはその最小多項式が係数整数の単係数多項式であることと同値で、特に \( \operatorname{Tr}_{K/\mathbb{Q}}(\alpha)\) と \(\operatorname{N}_{K/\mathbb{Q}}(\alpha)\) が整数であることを意味する。二次体の場合
\[
\operatorname{Tr}(\alpha)=2a,\qquad \operatorname{N}(\alpha)=a^2-b^2 m.
\]
したがって \(\alpha\) が整数ならば
\[
2a\in\mathbb{Z},\qquad a^2-b^2 m\in\mathbb{Z}.
\]
よって \(a\in\tfrac{1}{2}\mathbb{Z}\)。これを使って可能な \(a,b\) を絞り込む。

\(a=\dfrac{r}{2}\) 、 \(b=\dfrac{s}{2}\) と書ける（\(r,s\in\mathbb{Z}\)；もし \(b\) がより簡単に表せるならば \(s\) は偶数になる）。定数項の整数性を使うと
\[
a^2-b^2 m=\frac{r^2 - s^2 m}{4}\in\mathbb{Z}\quad\Longrightarrow\quad r^2 - s^2 m \equiv 0\pmod 4.
\]
ここで平方数の剰余は重要：任意の整数 \(t\) について \(t^2\equiv 0\) または \(1\pmod4\)（偶数なら0、奇数なら1）。

\(\;r^2\equiv s^2 m\pmod 4\) を場合分けする：

---

## (1) \(m\equiv 2\pmod4\) または \(m\equiv 3\pmod4\)

- \(m\equiv 2\) のとき：もし \(s\) が奇数なら \(s^2 m\equiv 1\cdot 2\equiv 2\pmod4\)、だが \(r^2\) は \(0\) か \(1\) であって \(2\) になりえない。したがって \(s\) は **偶数**。
- \(m\equiv 3\) のとき：もし \(s\) が奇数なら \(s^2 m\equiv 1\cdot 3\equiv 3\pmod4\)、だが \(r^2\) は \(0\) か \(1\) であって \(3\) になりえない。したがって \(s\) は **偶数**。

どちらの場合も \(s\) は偶数なので \(b=\dfrac{s}{2}\in\mathbb{Z}\)。また \(a=r/2\) だが \(2a=\)Tr\((\alpha)\in\mathbb{Z}\) より \(a\in\frac12\mathbb{Z}\)。しかし \(b\in\mathbb{Z}\) かつ \(a^2-b^2 m\in\mathbb{Z}\) を合わせると \(a\) も実際には整数でないと多項式係数の整合が取れない場合が残らない（詳細は下の逆向き包含で補足）。よってすべての代数的整数は \(a,b\in\mathbb{Z}\) の形、つまり
\[
\mathcal{O}_K=\mathbb{Z}[\sqrt{m}]
\]
となる。

（直観的には：半整数の \(b\) は許されず、よって \(\sqrt m\) を添えるだけの整係数多項式で閉じる。）

---

## (2) \(m\equiv 1\pmod4\)

この場合 \(m\equiv1\) なので \(s\) が奇数でも
\[
s^2 m\equiv 1\cdot 1\equiv1\pmod4
\]
となり、同様に \(r\) が奇数であれば \(r^2\equiv1\pmod4\) で
\(r^2-s^2 m\equiv 0\pmod4\) が成立する。したがって \(s\) が**奇数**で \(r\) も奇数、つまり \(a,b\) が両方とも半整数（分母が2）で **同じ余り（同じパリティ）** を持つ場合が可能になる。

その形は
\[
\alpha=\frac{r + s\sqrt{m}}{2},\qquad r\equiv s\pmod2,\ r,s\in\mathbb{Z}.
\]
特に \(r\) と \(s\) が両方奇数のとき \(r\equiv s\equiv1\pmod2\) と取れば
\[
\beta=\frac{1+\sqrt{m}}{2}
\]
が代数的整数である（最小多項式を確認すれば一目瞭然：\(\beta\) の最小多項式は \(x^2-x+\tfrac{1-m}{4}\)、右辺の定数は整数だから）。そして任意の \(\alpha\) は \(\mathbb{Z}[\beta]\) の元として書ける（\(s\) や \(r\) の取れる組により線形結合で表現可能）。したがって
\[
\mathcal{O}_K=\mathbb{Z}\!\left[\frac{1+\sqrt{m}}{2}\right].
\]

---

## 逆向き：包含の確認（整性の確認）
- \(\mathbb{Z}[\sqrt m]\subset\mathcal{O}_K\) は自明（\(\sqrt m\) の最小多項式 \(x^2-m\) は整係数なので \(\sqrt m\) は代数的整数）。
- \(m\equiv1\pmod4\) のとき \(\dfrac{1+\sqrt m}{2}\) が代数的整数であることは最小多項式 \(x^2-x+\dfrac{1-m}{4}\in\mathbb{Z}[x]\) を見ると明らか。したがって \(\mathbb{Z}[(1+\sqrt m)/2]\subset\mathcal{O}_K\)。
- 上のモジュロ論的議論で \(\mathcal{O}_K\) に含まれる任意の元がどちらかの形にしかなりえないことを示したので逆包含も得られ、等号になる。

---

# 判別式の計算（補足）
基底 \(\{1,\sqrt m\}\) の行列で体判別式を計算すると
\[
\operatorname{disc}(1,\sqrt m)=
\det\begin{pmatrix}1&\sqrt m\\1&-\sqrt m\end{pmatrix}^2=( -2\sqrt m )^2 =4m.
\]
したがって \(\mathbb{Z}[\sqrt m]\) が整数環であれば \(\Delta_K=4m\)。

一方 \(\{1,\tfrac{1+\sqrt m}{2}\}\) を基底とすると（\(m\equiv1\pmod4\) の場合）
その判別は計算すると \(\Delta_K=m\) になる（計算は行列を作って同様に行えば得られます）。これが上の公式の由来です。

---

# 例
- \(m=2\)（\(2\equiv2\pmod4\)）のとき \(\mathcal{O}_K=\mathbb{Z}[\sqrt2]\)、判別式 \(\Delta=8\).
- \(m=5\)（\(5\equiv1\pmod4\)）のとき \(\mathcal{O}_K=\mathbb{Z}\!\big[\tfrac{1+\sqrt5}{2}\big]\)。黄金比の元が整数環の生成元になる例です。判別式 \(\Delta=5\).

---

必要なら、もっと詳細に「\(r^2-s^2 m\equiv0\pmod4\) から各ステップを完全に展開した厳密な算術的ケース分け」や、判別式を行列で **明示的に計算する手順**（行列と行列式を示す）を書きます。どちらが見たいですか？
User
判別式って、なにに使うの？
ChatGPT
とてもいいところに注目しました！  
「判別式（discriminant）」は代数的整数論でとても基本的で重要な概念です。二次体に限らず数体の「整数環」を理解する上での道具になっています。  

---

## 判別式とは何か
数体 \(K\) の整数環 \(\mathcal{O}_K\) を考えると、\(\mathcal{O}_K\) は \(\mathbb{Z}\)-加群としてランク \([K:\mathbb{Q}]\) を持ちます。基底 \(\{\alpha_1,\dots,\alpha_n\}\) を取ると、各元のトレースを使って
\[
D(\alpha_1,\dots,\alpha_n)=\det\big(\mathrm{Tr}_{K/\mathbb{Q}}(\alpha_i\alpha_j)\big)_{1\le i,j\le n}
\]
を定義できます。この値を **判別式** と呼びます。基底を整数環の基底（整基底）に取ったときの判別式を、体 \(K\) の判別式 \(\Delta_K\) と呼びます。

---

## 判別式の役割
ざっくり言うと、判別式は「整数環の構造」「素数の分解」「代数的独立性」の指標です。具体的には：

### 1. 整数環の判定に使える
- 与えられた \(\mathbb{Z}\)-基底（たとえば \(\{1,\sqrt{m}\}\)）で判別式を計算して、もしそれが正しい \(\Delta_K\) でなければ、その基底は整数環の基底ではないことが分かります。
- 実際、二次体で「\(\mathbb{Z}[\sqrt m]\) が整数環になるか？」を判定するときに、判別式が役立ちます。

### 2. 素数の分解に現れる
- 素数 \(p\) が整数環 \(\mathcal{O}_K\) でどう分解するかを考えるとき、判別式 \(\Delta_K\) を割る素数が「例外的なふるまい（分岐）」をします。  
  - 具体的に：\(p\nmid \Delta_K\) のときは、剰余体上の多項式分解で素数分解の型が決まる。  
  - \(p\mid \Delta_K\) のときは「分岐」(ramification) が起こります。  
  したがって判別式は「どの素数が分岐するか」を一目で教えてくれる重要な不変量です。

### 3. 幾何や解析との接点
- 代数的整数論を幾何的に見れば、判別式は「整数環の決定的な特異性のデータ」を担っています。  
- Dedekind ζ関数やL関数の解析にも判別式が登場します。具体的に、数体の ζ関数 \(\zeta_K(s)\) には判別式がガンマ因子や解析的挙動の中に出てきます。

### 4. 代数方程式の解の性質
古典的な判別式（たとえば二次方程式の \(b^2-4ac\)）は根が重解を持つかどうかを判定する量でしたよね。数体の判別式も似た役割で、「基底が整基底かどうか」「素数が重なって分解するかどうか」をコントロールしています。

---

## 二次体でのイメージ
二次体 \(K=\mathbb{Q}(\sqrt m)\) の場合、
- \(m\equiv1\pmod4\) のとき \(\Delta_K=m\)、
- \(m\equiv2,3\pmod4\) のとき \(\Delta_K=4m\)。

これを見ると、\(\Delta_K\) は「どの素数が分岐するか」を完全に決めています。  
たとえば \(K=\mathbb{Q}(\sqrt{-5})\) では \(\Delta_K=-20\)。だから \(2\) と \(5\) が分岐素数になります。

---

✅ まとめると：  
判別式は
- 整数環を決定する  
- 分岐する素数を決める  
- ζ関数やL関数など解析的対象に現れる  
という三つの大役を果たしています。

---

次に、「素数の分解パターンが判別式とどう結びつくか（例：\(\mathbb{Q}(\sqrt{m})\) における素数の分解法則）」を、具体例付きで解説してみましょうか？
User
判別式で、なぜ分岐が分かるの？？
ChatGPT
いいところを突きましたね！  
「なぜ判別式で分岐（ramification）が分かるのか？」は、判別式の本質的な役割に直結しています。順を追って説明します。  

---

## 1. 分岐とは？
数体 \(K/\mathbb{Q}\) の素数分解は
\[
p\mathcal{O}_K = \mathfrak{p}_1^{e_1}\cdots \mathfrak{p}_g^{e_g}, \quad e_i\ge 1.
\]
ここで \(e_i\) を **分岐指数** といいます。  
もしどの \(\mathfrak{p}_i\) に対しても \(e_i=1\) なら「非分岐」。逆に、ある素数で \(e_i>1\) が起きると「分岐」しています。  

---

## 2. 判別式の定義の意味
判別式は
\[
\Delta_K = \det\big(\mathrm{Tr}_{K/\mathbb{Q}}(\alpha_i\alpha_j)\big)
\]
で定義される量でしたね。これは**整数環 \(\mathcal{O}_K\) の基底に付随する二次形式の行列式**です。  

重要な事実：
- \(\Delta_K\) が \(p\) で割り切れる ⇔ 行列 \(\big(\mathrm{Tr}(\alpha_i\alpha_j)\big)\) が \(\mathbb{F}_p\) 上で退化する。  
- つまり、「トレース形式（trace form）」が mod \(p\) で非退化でなくなる。

---

## 3. トレース形式と分岐のつながり
トレース形式は数体 \(K\) の元を「どう \(\mathbb{Q}\)-基底に射影するか」を表していて、mod \(p\) に落とすと「剰余環 \(\mathcal{O}_K/p\mathcal{O}_K\)」の性質に関係します。

- \(p\nmid \Delta_K\) の場合：トレース形式が mod \(p\) で非退化。すると \(\mathcal{O}_K\) は \(p\) で「きれいな基底」を持っていて、\(\mathcal{O}_K/p\) は分離的（separable）。つまり **分岐なし**。  

- \(p\mid \Delta_K\) の場合：トレース形式が mod \(p\) で退化。これは \(\mathcal{O}_K/p\) が非分離的（inseparable）になることを意味し、素数分解の際に **重複**（\(e_i>1\)）が必ず生じる。つまり分岐が起こる。

---

## 4. 二次体での直感的イメージ
二次体 \(K=\mathbb{Q}(\sqrt{m})\) の場合はもっと分かりやすい：

- 整数環 \(\mathcal{O}_K\) の判別式 \(\Delta_K\) は \(m\) か \(4m\)。  
- ある素数 \(p\) を考える。  
  - \(p\nmid \Delta_K\) のとき：多項式 \(x^2-m\)（あるいは \(x^2-x+\tfrac{1-m}{4}\)）を mod \(p\) で見れば、それが **既約か平方因子なしで分解するか**で、素数の分解型が決まる（分岐なし）。  
  - \(p\mid \Delta_K\) のとき：mod \(p\) でその多項式が平方因子を持つ（重根になる）。すると分解は
    \[
    p\mathcal{O}_K=\mathfrak{p}^2
    \]
    のように「重なり」が生じて分岐する。

**例**：  
\(K=\mathbb{Q}(\sqrt{-5})\) の判別式は \(-20\)。  
- \(\Delta_K=-20\) なので分岐する素数は \(2\) と \(5\)。  
実際に見ると：
\[
2\mathcal{O}_K=(2,1+\sqrt{-5})^2, \quad 5\mathcal{O}_K=(\sqrt{-5})^2.
\]
きれいに二乗が出てきています。  

---

## 5. まとめ
判別式は
- **トレース形式が mod \(p\) で退化するかどうか**を測る量で、  
- それが退化すると剰余環が「非分離的」になり、結果として素数が分岐する。  

したがって
\[
p \text{ が分岐 } \quad \Longleftrightarrow \quad p \mid \Delta_K.
\]

---

👉 このあと、「二次体における素数の分解の完全な分類（分岐・分解・不分解）を判別式と二次剰余記号で表す法則」を解説しましょうか？
User
ぜひ
ChatGPT
よし！では、二次体における素数の分解法則を **判別式** と **二次剰余記号**（Legendre記号 \(\left(\frac{\cdot}{p}\right)\)）を使って体系的にまとめます。  

---

# 二次体における素数分解の完全な分類

数体 \(K=\mathbb{Q}(\sqrt{m})\) （\(m\) は平方因子を含まない整数）の整数環 \(\mathcal{O}_K\) を考える。  
その判別式は
\[
\Delta_K=\begin{cases}
4m, & m\equiv 2,3 \pmod 4,\\
m, & m\equiv 1 \pmod 4.
\end{cases}
\]

## (1) \(p=2\) の場合
これは少し特殊（あとで例を示します）。とりあえず「特別扱い」と覚えておきましょう。  

---

## (2) 奇素数 \(p\) の場合
分類は次のようになります：

### (A) 分岐
\[
p \mid \Delta_K \quad \Longleftrightarrow \quad p \text{ は分岐する}.
\]
つまり分岐素数は判別式の素因数で一目瞭然。

---

### (B) 非分岐素数の場合（\(p\nmid \Delta_K\)）
このときの分解型は **二次剰余記号** \(\left(\frac{\Delta_K}{p}\right)\) によって決まります：

- **分解（split）**  
  \(\left(\frac{\Delta_K}{p}\right)=1\) のとき
  \[
  p\mathcal{O}_K=\mathfrak{p}_1\mathfrak{p}_2,\quad \mathfrak{p}_1\ne\mathfrak{p}_2.
  \]
  つまり \(p\) は異なる2つの素イデアルに分かれる。  

- **素数のまま（inert）**  
  \(\left(\frac{\Delta_K}{p}\right)=-1\) のとき
  \[
  p\mathcal{O}_K \text{ は素イデアルのまま（既約）}.
  \]

---

## まとめ（奇素数版）
\[
p\mathcal{O}_K = 
\begin{cases}
\mathfrak{p}^2, & p\mid \Delta_K \quad \text{（分岐）},\\[6pt]
\mathfrak{p}_1\mathfrak{p}_2, & \left(\dfrac{\Delta_K}{p}\right)=1 \quad \text{（分解）},\\[8pt]
\text{素数のまま}, & \left(\dfrac{\Delta_K}{p}\right)=-1 \quad \text{（不分解）}.
\end{cases}
\]

---

# 例題で確認

### 例1: \(K=\mathbb{Q}(\sqrt{-5})\)
- 判別式 \(\Delta_K=-20\).
- 分岐：\(|\Delta_K|\) の素因数は \(2,5\)。実際に \(2,5\) は分岐。
- \(p=3\) のとき：
  \(\left(\frac{-20}{3}\right) = \left(\frac{1}{3}\right)=1\)。したがって \(3\) は分解。
- \(p=7\) のとき：
  \(\left(\frac{-20}{7}\right) = \left(\frac{-6}{7}\right)=\left(\frac{1}{7}\right)\cdot\left(\frac{-1}{7}\right)\cdot\left(\frac{2}{7}\right)= -1\)。したがって \(7\) は不分解（inert）。

---

### 例2: \(K=\mathbb{Q}(\sqrt{5})\)
- 判別式 \(\Delta_K=5\).
- 分岐：\(p=5\).
- \(p=11\) のとき：
  \(\left(\frac{5}{11}\right)=\left(\frac{11}{5}\right)\)（相互法則）=\(\left(\frac{1}{5}\right)=1\)。したがって \(11\) は分解。
- \(p=3\) のとき：
  \(\left(\frac{5}{3}\right)=2^2\equiv -1\pmod3\)。したがって \(3\) は不分解。

---

# まとめ直感
- **判別式の素因数 = 分岐素数**。  
- **それ以外の奇素数は Legendre記号 \(\left(\frac{\Delta}{p}\right)\) で「分解 or 不分解」が即決まる」**。  

これが二次体での素数分解の完全ルールです。  

---

👉 ここで質問：  
「特殊な素数 \(p=2\) の場合の分解法則」も整理して見たいですか？  
それともまず「上の一般のルールを他の具体例でもっと演習」して確認しますか？
User
le gendre記号とは？
ChatGPT
いい質問です！  
「Legendre（ルジャンドル）記号」は、**素数 \(p\) を法としてある整数 \(a\) が二次剰余かどうかを判定する記号**です。  

---

## 定義
奇素数 \(p\) に対して、整数 \(a\) に対し

\[
\left(\frac{a}{p}\right)=
\begin{cases}
\;\;0 & \text{もし } p\mid a,\\[6pt]
\;\;1 & \text{もし } a \not\equiv 0 \pmod{p} \text{ かつ } x^2\equiv a \pmod{p} \text{ が解を持つ},\\[6pt]
-1 & \text{もし } x^2\equiv a \pmod{p} \text{ が解を持たない}.
\end{cases}
\]

つまり：
- \(\left(\tfrac{a}{p}\right)=1\) ⇔ \(a\) は mod \(p\) で平方数。  
- \(\left(\tfrac{a}{p}\right)=-1\) ⇔ \(a\) は mod \(p\) で平方でない。  
- \(\left(\tfrac{a}{p}\right)=0\) ⇔ \(p\mid a\)。  

これが「二次剰余記号」です。  

---

## 性質
Legendre記号には便利な性質がたくさんあります。

1. **乗法性**  
   \[
   \left(\frac{ab}{p}\right) = \left(\frac{a}{p}\right)\left(\frac{b}{p}\right).
   \]

2. **Eulerの基準**  
   \(a^{\frac{p-1}{2}} \equiv \left(\tfrac{a}{p}\right) \pmod{p}\).  
   （これで高速に計算できる！）

3. **二次相互法則**（Quadratic Reciprocity）  
   奇素数 \(p,q\) に対して
   \[
   \left(\frac{p}{q}\right)\left(\frac{q}{p}\right) = (-1)^{\frac{(p-1)(q-1)}{4}}.
   \]
   特に \(p\equiv q\equiv 3\pmod{4}\) のときだけ \(-1\) になり、それ以外では \(+1\)。

4. **特殊な値**  
   - \(\left(\tfrac{-1}{p}\right)=(-1)^{\frac{p-1}{2}}=\begin{cases}1 & p\equiv1\pmod4 \\ -1 & p\equiv3\pmod4\end{cases}\)  
   - \(\left(\tfrac{2}{p}\right)=(-1)^{\frac{p^2-1}{8}}=\begin{cases}1 & p\equiv \pm1\pmod8 \\ -1 & p\equiv \pm3\pmod8\end{cases}\)

---

## 例
- \(\left(\tfrac{2}{7}\right)\):  
  mod 7 の平方は \(1^2=1, 2^2=4, 3^2=2, 4^2=2, 5^2=4, 6^2=1\)。  
  よって 2 は平方数 mod 7。したがって \(\left(\tfrac{2}{7}\right)=1\)。  

- \(\left(\tfrac{3}{7}\right)\):  
  mod 7 の平方を列挙しても 3 は出てこない。したがって \(\left(\tfrac{3}{7}\right)=-1\)。  

---

## 二次体の素数分解との関係
さっきの法則に戻ると：
\[
p \nmid \Delta_K \quad\Rightarrow\quad
\begin{cases}
\left(\frac{\Delta_K}{p}\right)=1 &\Rightarrow p \text{ は分解},\\
\left(\frac{\Delta_K}{p}\right)=-1 &\Rightarrow p \text{ は不分解}.
\end{cases}
\]

つまり Legendre記号は「素数の分解型を一発で教えてくれるツール」なのです。  

---

👉 ここで確認ですが：  
次に **具体的に「二次相互法則」を使って Legendre記号を素早く計算する実例**を見たいですか？  
それともまず「二次体における素数分解の例題演習」をもっとやりたいですか？
User
二次相互法則とは？？
ChatGPT
いい流れですね！  
「二次相互法則（Quadratic Reciprocity）」は、**初等数論で最重要の定理のひとつ**です。  
Legendre記号の計算を一気に楽にする「究極の法則」といわれます。  

---

## 1. 直感から
Legendre記号 \(\left(\frac{a}{p}\right)\) は「\(a\) が mod \(p\) で平方かどうか」を判定する記号でした。  
素数 \(p,q\) があるとき、
- \(\left(\frac{p}{q}\right)\) は「\(p\) が mod \(q\) で平方かどうか」。  
- \(\left(\frac{q}{p}\right)\) は「\(q\) が mod \(p\) で平方かどうか」。  

二次相互法則は、この2つの情報に強い対称性があることを述べています。  

---

## 2. 定理（Gauss）
奇素数 \(p,q\) に対して
\[
\left(\frac{p}{q}\right)\left(\frac{q}{p}\right) = (-1)^{\frac{(p-1)(q-1)}{4}}.
\]

つまり：
- \(p \equiv 1 \pmod 4\) または \(q \equiv 1 \pmod 4\) の場合
  \[
  \left(\frac{p}{q}\right)=\left(\frac{q}{p}\right).
  \]
- \(p \equiv q \equiv 3 \pmod 4\) の場合
  \[
  \left(\frac{p}{q}\right)=-\left(\frac{q}{p}\right).
  \]

---

## 3. 付随する補助法則（よく一緒に使う）
- \(\displaystyle \left(\frac{-1}{p}\right) = (-1)^{\frac{p-1}{2}} = \begin{cases}1 & p\equiv 1\pmod 4\\ -1 & p\equiv 3\pmod 4\end{cases}\)
- \(\displaystyle \left(\frac{2}{p}\right) = (-1)^{\frac{p^2-1}{8}} = \begin{cases}1 & p\equiv 1,7 \pmod 8 \\ -1 & p\equiv 3,5 \pmod 8\end{cases}\)

これで任意の \(\left(\frac{a}{p}\right)\) を効率的に計算できます。  

---

## 4. 例題で確認
### 例1
\(\left(\tfrac{3}{11}\right)\) を計算したい。  
二次相互法則を使うと
\[
\left(\frac{3}{11}\right)\left(\frac{11}{3}\right) = (-1)^{\frac{(3-1)(11-1)}{4}} = (-1)^{\frac{2\cdot 10}{4}} = (-1)^5=-1.
\]
さて \(\left(\frac{11}{3}\right)=\left(\frac{2}{3}\right)=-1\)。  
したがって
\[
\left(\frac{3}{11}\right) = -\left(\frac{11}{3}\right)= -(-1)=1.
\]
つまり 3 は mod 11 で平方！ 実際 \(5^2=25\equiv3\pmod{11}\)。  

---

### 例2
\(\left(\tfrac{5}{7}\right)\) を計算したい。  
二次相互法則より
\[
\left(\frac{5}{7}\right)\left(\frac{7}{5}\right) = (-1)^{\frac{(5-1)(7-1)}{4}}=(-1)^{\frac{4\cdot 6}{4}}=(-1)^6=1.
\]
だから \(\left(\frac{5}{7}\right)=\left(\frac{7}{5}\right)\)。  
一方 \(\left(\frac{7}{5}\right)=\left(\frac{2}{5}\right)=-1\)。  
したがって \(\left(\frac{5}{7}\right)=-1\)。  
つまり 5 は mod 7 で平方でない。  

---

## 5. 二次体の分解との関係
先ほどのルールを思い出すと：

- \(p\nmid \Delta_K\) のとき  
  \(\left(\frac{\Delta_K}{p}\right)=1 \implies p\) は分解  
  \(\left(\frac{\Delta_K}{p}\right)=-1 \implies p\) は不分解  

ここで Legendre記号を効率的に計算するのに「二次相互法則」を使うのです。  
つまり：**二次体の素数分解の決定は、二次相互法則による数論的な計算問題に帰着する**のです。  

---

👉 ここで質問ですが、  
次は「二次体における素数分解の判定を、実際に **二次相互法則を使って** 素早くやる演習」をしてみますか？
User
平方剰余法則？って結局何だったの？？
ChatGPT
いいところに気づきました 👍  
「平方剰余法則」というのは、まさに **二次相互法則（二次の相互法則）** の別名（日本語的な呼び方）です。  

---

## 1. 言葉の整理
- **平方剰余（quadratic residue）**：  
  \(a\) が素数 \(p\) に対して「平方の剰余」になるとは、  
  \[
  \exists x:\; x^2 \equiv a \pmod p
  \]
  が解をもつこと。  

- **平方剰余法則**とは：  
  ある素数 \(q\) が別の素数 \(p\) に対して平方剰余かどうかを、逆にした \(\left(\frac{p}{q}\right)\) から判定できる、という法則。  
  つまり **「平方剰余の対称性を支配する究極のルール」** です。  

---

## 2. 定理のかたち（復習）
奇素数 \(p,q\) に対して
\[
\left(\frac{p}{q}\right)\left(\frac{q}{p}\right) = (-1)^{\frac{(p-1)(q-1)}{4}}.
\]

- \(p \equiv 1 \pmod 4\) または \(q \equiv 1 \pmod 4\) のとき  
  \(\;\left(\frac{p}{q}\right)=\left(\frac{q}{p}\right)\)  

- \(p \equiv q \equiv 3 \pmod 4\) のとき  
  \(\;\left(\frac{p}{q}\right)=-\left(\frac{q}{p}\right)\)  

---

## 3. 具体的な意味
「平方剰余法則」とはつまり：

- **素数 \(p,q\) に対して**
  - \(p\) が \(q\) の平方剰余であるかどうか  
  - \(q\) が \(p\) の平方剰余であるかどうか  

この **二つの判定問題はほとんど同じ情報を持っている**、という驚くべき対称性を述べた定理。  

---

## 4. 歴史的背景
- ガウス（Carl Friedrich Gauss）が「数論の宝石」と呼んだほど重要。  
- 実際ガウスは、この法則の証明を 6 通り以上も残している。  
- 「相互法則」の最初の例であり、より高次の相互法則（立方・四次・一般のアーベル拡大理論）へと広がっていく出発点。  

---

✅ まとめると：  
**「平方剰余法則」とは、Legendre記号の相互関係を述べる「二次相互法則」のこと**です。  
つまり「平方が mod p で解をもつかどうか」を決める究極のルール。  

---

つぎのステップとしては、これを「二次体の素数分解」とどう直結するかを、具体的に演習で見てみるのがおすすめです。  
👉 たとえば「\(K=\mathbb{Q}(\sqrt{5})\) における素数 \(p\) の分解を平方剰余法則で判定する」など。  

やってみますか？
User
ぜひ！！それから、代数体の一般的な性質も教えてほしい
ChatGPT
いいですね！それでは二段構成でいきましょう ✨  

---

# Part 1. 具体例：\(\mathbb{Q}(\sqrt{5})\) における素数分解

## 1. 判別式の確認
二次体 \(K=\mathbb{Q}(\sqrt{d})\) の整数環の判別式 \(\Delta_K\) は、  
- \(d \equiv 1 \pmod 4 \;\Rightarrow\; \Delta_K = d\)  
- \(d \equiv 2,3 \pmod 4 \;\Rightarrow\; \Delta_K = 4d\)  

今回 \(d=5 \equiv 1 \pmod 4\) なので  
\[
\Delta_K = 5.
\]

---

## 2. 素数の挙動
素数 \(p\) に対して：
- \(p=5\)：判別式を割るので **分岐**  
- \(p \neq 5\)：次を調べる：
  \[
  \left(\frac{\Delta_K}{p}\right) = \left(\frac{5}{p}\right)
  \]

- \(\left(\frac{5}{p}\right)=1 \implies p\) は **分解**  
- \(\left(\frac{5}{p}\right)=-1 \implies p\) は **素イデアルのまま（不分解）**

---

## 3. 平方剰余法則で具体的に判定
平方剰余法則により：
\[
\left(\frac{5}{p}\right)\left(\frac{p}{5}\right) = (-1)^{\frac{(5-1)(p-1)}{4}} = (-1)^{\frac{4(p-1)}{4}} = (-1)^{p-1} = 1.
\]

したがって
\[
\left(\frac{5}{p}\right) = \left(\frac{p}{5}\right).
\]

つまり **「5が平方剰余 mod \(p\) かどうか」は「\(p\) が mod 5 で平方剰余かどうか」と一致する**。

---

## 4. mod 5 の平方剰余
平方剰余 mod 5 は \(\{1,4\}\)。非平方剰余は \(\{2,3\}\)。  

だから：
- \(p \equiv 1,4 \pmod 5 \implies p\) は **分解**  
- \(p \equiv 2,3 \pmod 5 \implies p\) は **不分解**  
- \(p=5 \implies\) **分岐**

---

### 🎯 まとめ（\(\mathbb{Q}(\sqrt{5})\) における素数の分解）
- \(p=5\)：分岐  
- \(p \equiv 1,4 \pmod 5\)：分解  
- \(p \equiv 2,3 \pmod 5\)：不分解  

平方剰余法則の威力がここに出ていますね！  

---

# Part 2. 代数体の一般的な性質

代数体（数体ともいう） \(K/\mathbb{Q}\) の世界には共通の構造があります。  

## 1. 整数環 \(\mathcal{O}_K\)
- 代数体の「自然な整数」の集合。  
- \(\mathbb{Z}\) の拡張版で、単に「有理数係数の整式で割れない多項式の根」が生成する。  

---

## 2. イデアル分解
- \(\mathcal{O}_K\) は一般には **一意分解整域ではない**。  
- 代わりに「イデアル」での一意分解が成り立つ：  
  \[
  (p) = \mathfrak{p}_1^{e_1}\cdots \mathfrak{p}_g^{e_g}
  \]
- \(e_i\) を **分岐指数**、\(\mathrm{N}(\mathfrak{p}_i)\) を **剰余次数**と呼び、積の関係  
  \[
  \sum_i e_i f_i = [K:\mathbb{Q}]
  \]
  が成り立つ。  

---

## 3. 判別式と分岐
- 判別式 \(\Delta_K\) は、素数分岐の情報を符号化している。  
- \(p\mid \Delta_K \implies p\) は分岐。  

---

## 4. 単数群（Units）
- \(\mathcal{O}_K^\times\)（単数群）は Dirichlet の単数定理で記述される：  
  \[
  \mathcal{O}_K^\times \cong \mu_K \times \mathbb{Z}^{r+s-1}
  \]
  （\(\mu_K\) は根号的な単数群、\(r\) は実埋め込みの数、\(s\) は複素埋め込みの数）

---

## 5. 類数
- イデアル分解が唯一性を失う度合いを測る量が **類数 \(h_K\)**。  
- \(h_K=1\) ⇔ \(\mathcal{O}_K\) が一意分解整域。  

---

## 6. ゼータ関数とL関数
- Dedekind ゼータ関数 \(\zeta_K(s)\) は \(\mathcal{O}_K\) のイデアル全体を使って定義される。  
- \(\zeta_K(s)=\prod_\mathfrak{p} (1-\mathrm{N}(\mathfrak{p})^{-s})^{-1}\)  
- 解析的性質と数論的性質（類数公式、素数分解の密度）がリンクしている。  

---

✅ まとめると：  
代数体は
- 整数環  
- 素数イデアル分解（分岐・分解・不分解）  
- 判別式  
- 単数群  
- 類数  
- ゼータ関数  

といった道具で記述され、それが数論の核心につながっています。  

---

👉 次にやると面白いのは、具体的な他の二次体（たとえば \(\mathbb{Q}(\sqrt{-1})\) や \(\mathbb{Q}(\sqrt{-2})\)）でも素数の分解をやって比較することです。  

やってみますか？
User
ぜひ！！そのあとの会話で、ここまでの会話をもとに目次を整理してほしい
ChatGPT
いいですね！ではまず、さっきの \(\mathbb{Q}(\sqrt{5})\) の例と同じように、**他の二次体で素数分解を見ていきましょう**。  

---

# Part A. \(\mathbb{Q}(\sqrt{-1})\) の場合

## 1. 判別式
\(\;d=-1\equiv 3\pmod 4\)  
→ 判別式は \(\Delta=-4\)。  

## 2. 素数の分解
- \(p=2\)：判別式を割るので **分岐**  
- \(p\neq 2\)：  
  \[
  \left(\frac{\Delta}{p}\right) = \left(\frac{-4}{p}\right) = \left(\frac{-1}{p}\right).
  \]
- よって
  - \(p\equiv 1 \pmod 4 \implies p\) は **分解**  
  - \(p\equiv 3 \pmod 4 \implies p\) は **不分解**

### 🎯 まとめ
- \(2\)：分岐  
- \(p\equiv 1\pmod 4\)：分解  
- \(p\equiv 3\pmod 4\)：不分解  

（これはガウス整数 \(\mathbb{Z}[i]\) の素数分解則として有名ですね！）

---

# Part B. \(\mathbb{Q}(\sqrt{-2})\) の場合

## 1. 判別式
\(\;d=-2\equiv 2\pmod 4\)  
→ 判別式は \(\Delta=-8\)。  

## 2. 素数の分解
- \(p=2\)：分岐  
- \(p\neq 2\)：  
  \[
  \left(\frac{-8}{p}\right) = \left(\frac{-1}{p}\right)\left(\frac{2}{p}\right).
  \]

- よって：
  - \(p\equiv 1,3 \pmod 8 \implies\) 分解  
  - \(p\equiv 5,7 \pmod 8 \implies\) 不分解  

---

# Part C. まとめ比較

| 体 \(K\) | 判別式 \(\Delta\) | 分岐素数 | 分解条件 | 不分解条件 |
|----------|----------------|----------|----------------|----------------|
| \(\mathbb{Q}(\sqrt{5})\) | \(5\) | \(5\) | \(p\equiv 1,4 \pmod 5\) | \(p\equiv 2,3 \pmod 5\) |
| \(\mathbb{Q}(\sqrt{-1})\) | \(-4\) | \(2\) | \(p\equiv 1 \pmod 4\) | \(p\equiv 3 \pmod 4\) |
| \(\mathbb{Q}(\sqrt{-2})\) | \(-8\) | \(2\) | \(p\equiv 1,3 \pmod 8\) | \(p\equiv 5,7 \pmod 8\) |

---

こうやって見ると、**分解条件は「判別式 \(\Delta\) による平方剰余判定」で決まる**ことがはっきりしますね。  
そして実際の計算は **二次相互法則（平方剰余法則）** があるからこそ手早くできる！  

---

👉 次はご要望通り、ここまでの「二次体・平方剰余法則・分解則・代数体の一般的性質」を見やすく整理した「目次」を作りましょうか？
User
ぜひ！
ChatGPT
了解しました ✅  
ここまでの流れを整理して「目次」スタイルでまとめます。  

---

# 目次：二次体と平方剰余法則を通じて学ぶ代数体の性質

## 第1章　二次体と整数環
1. 二次体 \(K=\mathbb{Q}(\sqrt{d})\) の定義  
2. 整数環 \(\mathcal{O}_K\) の構造  
   - \(d\equiv 1\pmod 4 \;\Rightarrow\; \mathcal{O}_K=\mathbb{Z}\big[\tfrac{1+\sqrt{d}}{2}\big]\)  
   - それ以外 \(\;\Rightarrow\; \mathcal{O}_K=\mathbb{Z}[\sqrt{d}]\)  
3. 判別式 \(\Delta_K\) の定義と計算  

---

## 第2章　判別式と素数分解
1. 判別式が「分岐素数」を決める  
   - \(p\mid \Delta_K \;\Rightarrow\; p\) は分岐  
2. \(p\nmid \Delta_K\) の場合の判定  
   - \((\Delta_K/p)=1 \implies p\) 分解  
   - \((\Delta_K/p)=-1 \implies p\) 不分解  

---

## 第3章　Legendre記号と平方剰余
1. Legendre記号 \(\left(\tfrac{a}{p}\right)\) の定義  
2. 性質（乗法性、オイラーの判定法）  
3. 小さな補助法則  
   - \(\left(\tfrac{-1}{p}\right)\)  
   - \(\left(\tfrac{2}{p}\right)\)  

---

## 第4章　二次相互法則（平方剰余法則）
1. 定理の主張  
   \[
   \left(\tfrac{p}{q}\right)\left(\tfrac{q}{p}\right)=(-1)^{\frac{(p-1)(q-1)}{4}}
   \]
2. ケース分け（\(p,q\equiv 1,3 \pmod 4\)）  
3. 計算例  
   - \(\left(\tfrac{3}{11}\right)\), \(\left(\tfrac{5}{7}\right)\)  
4. 歴史的背景（ガウスの「数論の宝石」）  

---

## 第5章　二次体の具体例
1. \(\mathbb{Q}(\sqrt{5})\)  
   - \(\Delta=5\)  
   - 分岐：\(p=5\)  
   - 分解：\(p\equiv 1,4\pmod 5\)  
   - 不分解：\(p\equiv 2,3\pmod 5\)  
2. \(\mathbb{Q}(\sqrt{-1})\)（ガウス整数）  
   - \(\Delta=-4\)  
   - 分岐：\(p=2\)  
   - 分解：\(p\equiv 1\pmod 4\)  
   - 不分解：\(p\equiv 3\pmod 4\)  
3. \(\mathbb{Q}(\sqrt{-2})\)  
   - \(\Delta=-8\)  
   - 分岐：\(p=2\)  
   - 分解：\(p\equiv 1,3\pmod 8\)  
   - 不分解：\(p\equiv 5,7\pmod 8\)  

---

## 第6章　代数体の一般的性質
1. 整数環と一意分解の崩壊  
   - イデアル分解で一意性を回復  
2. 分岐指数と剰余次数  
   - \(\sum e_i f_i = [K:\mathbb{Q}]\) の関係  
3. 単数群と Dirichlet の単数定理  
   - \(\mathcal{O}_K^\times \cong \mu_K \times \mathbb{Z}^{r+s-1}\)  
4. 類数 \(h_K\) と類体論  
   - \(h_K=1 \Leftrightarrow\) 一意分解整域  
5. Dedekind ゼータ関数と解析的性質  

---

✅ これで「二次体から一般の代数体の基本構造」までを一通りカバーできました。  

---

👉 次に発展させるなら、「類数1の二次体（いわゆるヒルベルトの9つの体）」や、「ゼータ関数を使った素数分布の理解」などが面白いです。  

つづきは「類数の小さい体」か「ゼータ関数・L関数」に進めますか？
User
ゼータ関数と素数の分布についてまとめてほしい！！これで終わり！！
ChatGPT
いいですね！ラストにふさわしいテーマです 🎯  
「ゼータ関数と素数の分布」について、代数体の視点も交えつつまとめます。  

---

# ゼータ関数と素数の分布

## 1. リーマンゼータ関数 \(\zeta(s)\)
定義：
\[
\zeta(s) = \sum_{n=1}^\infty \frac{1}{n^s}, \quad \Re(s) > 1
\]

オイラー積展開：
\[
\zeta(s) = \prod_{p \ \text{prime}} \frac{1}{1-p^{-s}}
\]

👉 ここで素数がゼータ関数の「因数分解」に出てくる。  
つまり **ゼータ関数の性質＝素数の分布の情報**。

---

## 2. 素数定理
素数の分布は
\[
\pi(x) \sim \frac{x}{\log x}, \quad x\to\infty
\]
で表される。  
ここで \(\pi(x)\) は \(x\) 以下の素数の個数。  

この結果はゼータ関数の解析的性質（特に \(\zeta(s)\) に虚軸上の極がないこと）から導かれる。  

---

## 3. ゼータ関数の零点
- \(\zeta(s)\) の「非自明な零点」は \(0<\Re(s)<1\) にある。  
- 素数分布の誤差項は零点の位置に支配される。  

リーマン予想：
\[
\text{全ての非自明零点は }\Re(s)=\tfrac{1}{2} \text{ 上にある}
\]
もしこれが真なら、素数分布の誤差項は非常に良く抑えられる。  

---

## 4. 一般代数体の場合：Dedekind ゼータ関数
代数体 \(K\) に対して
\[
\zeta_K(s) = \sum_{\mathfrak{a}\neq 0} \frac{1}{N(\mathfrak{a})^s}
= \prod_{\mathfrak{p}} \frac{1}{1-N(\mathfrak{p})^{-s}}
\]

ここで：
- \(\mathfrak{a}\)：非零イデアル  
- \(\mathfrak{p}\)：素イデアル  
- \(N(\mathfrak{a})\)：ノルム（イデアルの剰余環の大きさ）  

👉 \(\zeta_K(s)\) には素イデアルの分布が完全に符号化されている。  

---

## 5. ゼータ関数の解析的性質
- \(s=1\) に極をもつ（素数や素イデアルが無限に存在することに対応）  
- メルテンス型の定理、素数定理の一般化も成り立つ：  
  \[
  \pi_K(x) \sim \frac{x}{\log x}, \quad x\to\infty
  \]
  ここで \(\pi_K(x)\) はノルムが \(\leq x\) の素イデアルの個数。  

---

## 6. ゼータと類数公式
\(\zeta_K(s)\) の \(s=1\) の近傍の振る舞いは、代数体の基本的不変量を与える：
\[
\lim_{s\to 1}(s-1)\zeta_K(s) = \frac{2^{r}(2\pi)^{s}h_K R_K}{w_K\sqrt{|\Delta_K|}}
\]
- \(h_K\)：類数  
- \(R_K\)：レギュレーター（単数群の体積）  
- \(\Delta_K\)：判別式  
- \(w_K\)：根号単数の数  

👉 ゼータ関数は「素数の分布」と「代数体の内部構造」をつなぐ橋。  

---

## 7. まとめ
- ゼータ関数は「素数の分布」を解析的にコントロールする道具。  
- \(\zeta(s)\) から素数定理が出る。  
- Dedekind ゼータ関数 \(\zeta_K(s)\) は「素イデアルの分布」を記述。  
- 零点の位置（リーマン予想・一般化リーマン予想）が素数の分布精度を決める。  
- \(s=1\) の挙動は類数公式を与え、代数体の深い情報に結びつく。  

---

✨ これで、「二次体 → 平方剰余法則 → 素数分解 → 代数体一般 → ゼータ関数と素数分布」ときれいに一周しました！  

---

ご希望なら最後に、この流れを **図解（フローチャート）** にして「素数・判別式・ゼータ関数」の関係をまとめることもできますが、やりますか？
