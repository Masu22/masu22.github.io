# 階乗を含む不定方程式って、どんなパターンがある？？そして、どう解くのか？？まとめてほしい！！

いいテーマですね！✨
「階乗を含む不定方程式」にはいくつかの典型パターンがあって、解法も整数論・初等的推論・p進評価（Legendreの定理）などを組み合わせていきます。まとめてみますね！

---

# 🌟 階乗を含む不定方程式の典型パターンと解法まとめ

## 1. **単純な階乗の比較型**

例:

$$
n! = m!
$$

* 明らかに $n=m$ しかない。

拡張型：

$$
n! = m
$$

* $m$ が階乗数であるかどうかの判定問題になる。
* 解は「$m$ が 1, 2, 6, 24, … に一致する場合のみ」。

---

## 2. **階乗と累乗の比較**

例:

$$
n! = m^k
$$

* 階乗が「完全冪」になる問題。
* 例えば $n! = m^2$（階乗が平方数か？）。

  * $1!=1$, $2!=2$, $3!=6$, $4!=24$, $5!=120$, $6!=720$, … を調べると、実は**小さな場合しか平方数にならない**。
  * 判定には **素因数分解** & **指数の偶奇** を使う。
  * 一般に Legendre の定理で $n!$ に含まれる素数の指数を評価し、完全冪条件を調べる。

例:

$$
n! = k^n
$$

* 「階乗と累乗の釣り合い問題」
* Stirling の近似 $n! \approx (n/e)^n \sqrt{2\pi n}$ を使い、漸近的に解が有限個しかないことを示せる。

---

## 3. **階乗と多項式の等式**

例:

$$
n! = m^2+1
$$

* Pell 方程式の形に落ちることがある。
* 例えば $n!=m^2+1$ は **Brocard–Ramanujan問題** として知られている。

  * 既知の解は $n=4,5,7$ だけ（未解決問題）。

---

## 4. **階乗と和の関係**

例:

$$
n! = a+b
$$

* 例えば「階乗を2つの階乗で表せるか？」

$$
n! = m! + k!
$$

* これはほとんど解が存在せず、小さな場合を調べるしかない。

---

## 5. **階乗と素数**

例:

$$
n! \pm 1 = p
$$

* Wilson の定理や素数判定と関わる。
* $n!+1$ が素数になるのは「階乗素数」と呼ばれる（既知の例は少ない）。
* $n!-1$ も同様に「階乗素数」として研究対象。

---

## 6. **階乗の差**

例:

$$
n! - m! = k
$$

* $n! - m!$ は急速に大きくなるため、解は小さな $n,m$ しか存在しない。
* 具体的には $5! - 4! = 120-24=96$ など。
* 解析的には「有限個の解」しかないと期待される。

---

## 7. **階乗と線形・指数型の混合**

例:

$$
n! = 2^m
$$

* 階乗が 2 の累乗になるか？
* $n=1\ (1!=1)$, $n=2\ (2!=2)$, $n=3\ (3!=6\neq 2^m)$ 以降は無理。
* 理由：3以上なら奇数素因数が含まれるため。
* 一般化して $n! = a^m b^k$ を考えると「$n!$ の素因数分解が制約を満たすかどうか」の問題になる。

---

## 8. **ディオファントス方程式的難問**

* Brocard–Ramanujan問題: $n!+1 = m^2$（未解決）。
* Erdős–Selfridge定理: 階乗の和がべき乗にならない。
* $n! = F_m$（フィボナッチ数との一致）。これも有限個の解のみ。

---

# 🎯 解法の基本手法まとめ

1. **素因数分解**

   * Legendre の定理:
     $\nu_p(n!) = \sum_{k=1}^\infty \left\lfloor \frac{n}{p^k} \right\rfloor$
     （$n!$ に含まれる素数 $p$ の指数）
   * 完全冪かどうかを判定。

2. **漸近評価**

   * Stirling 近似で $n!$ の成長を調べ、有限個しか解がないことを示す。

3. **既知の未解決問題と照合**

   * Brocard–Ramanujan, 階乗素数, Erdős–Selfridge定理など。

4. **小さい場合を直接計算**

   * 階乗は急成長するので、数値実験でほぼ決まる。

---

✅ まとめると：

* **簡単な比較型は直接計算と素因数分解**。
* **累乗との比較は Legendre 定理＋Stirling 近似**。
* **平方数や1違いは有名未解決問題**。
* **和や差は有限個の解しかない**。

---

👉 質問ですが、あなたは「網羅的なパターン整理」が欲しいですか？
それとも「実際に例題を解いていく（例えば $n! = m^2+1$ の場合を詳しく）」方がいいですか？

---
---

# パターン整理をぜひ！

なるほど！🔎
では「階乗を含む不定方程式」を **出題パターンごとに整理した体系的目次** を作ってみますね。

---

# 📚 階乗を含む不定方程式のパターン整理

## Ⅰ. **同一型・比較型**

* **等式**

  * $n! = m!$ ⇒ 自明解 $n=m$ のみ
  * $n! = m$ ⇒ $m$ が階乗数かどうかの判定
* **差**

  * $n! - m! = k$（有限個の解のみ、小さな場合の探索）
* **比**

  * $\dfrac{n!}{m!} = k$（整数条件＝積の形）

---

## Ⅱ. **階乗と累乗の比較**

* **累乗との直接比較**

  * $n! = m^k$（完全冪問題 → Legendre の定理で素因数指数を調べる）
  * $n! = m^2$, $n! = m^3$, …
* **べき乗と同指数比較**

  * $n! = k^n$（Stirling 近似で有限解）
  * $n! = a^m$（階乗が純粋な冪になるか？）
* **累乗との加減**

  * $n! \pm 1 = m^k$（特に平方数は Brocard–Ramanujan 問題）

---

## Ⅲ. **階乗と素数**

* **素数との一致**

  * $n! \pm 1 = p$（階乗素数）
* **素因数分解に関する条件**

  * $n!$ が素数の積に制約を持つ場合
  * 例: $n! = 2^a \cdot 3^b$ のみで表せるか？

---

## Ⅳ. **階乗と線形関係**

* **和の形**

  * $n! = m! + k!$（有限解）
  * $n! = a + b$（特定の整数分解）
* **差の形**

  * $n! - m! = k$（小さい差のみ可能）

---

## Ⅴ. **階乗と既知数列の関係**

* フィボナッチ数: $n! = F_m$
* カタラン数、ベル数、分割数などとの一致
* 素数列: $n!+1=p_m$（$p_m$はm番目の素数）

---

## Ⅵ. **階乗と合同条件**

* **Wilson型**

  * $(p-1)! \equiv -1 \pmod{p}$
  * $n!\equiv m \pmod{p}$ での解の存在
* **中国剰余定理と組合せ**

---

## Ⅶ. **階乗と指数的成長の比較**

* **2の冪との比較**

  * $n! = 2^m$ ⇒ 小さい $n$ 以外不可
* **一般指数との比較**

  * $n! = a^m b^k$ 形式
* **漸近比較**

  * Stirling 近似で $n! \sim (n/e)^n$ と累乗や指数関数の釣り合いを調べる

---

## Ⅷ. **未解決問題・深いテーマ**

* **Brocard–Ramanujan問題**

  * $n! + 1 = m^2$（既知の解: $n=4,5,7$）
* **Erdős–Selfridge定理**

  * 階乗の和は完全冪にならない
* **階乗素数問題**

  * $n! \pm 1$ の素数は有限か？
* **Catalan型（Mihăilescuの定理と関連）**

  * $n! = m^k + 1$ に有限解しかないことの期待

---

# 🎯 まとめ

「階乗を含む不定方程式」は大きく分けると：

1. **比較型（等式・差・比）**
2. **累乗との関係（完全冪や累乗との差）**
3. **素数との関係（階乗素数・Wilsonの定理型）**
4. **他の数列との一致（フィボナッチなど）**
5. **合同条件（剰余算術との組み合わせ）**
6. **漸近比較（Stirlingを使う）**
7. **未解決問題群（Brocard–Ramanujan, Erdős–Selfridge, 階乗素数）**

👉 この枠組みに当てはめれば、ほとんどの「階乗入り不定方程式」を整理できます！

---

ご希望なら、次のステップで「各カテゴリごとの典型例題＋解法スケッチ」を作って問題集っぽくできますけど、そうしますか？

---
---

# 詳しい説明

了解です！
では、先ほどの分類に基づいて、各カテゴリごとに：

* 典型的な例題（レベル別）
* 解法の方針（ポイント解説）
* 必要な理論（テクニック紹介）

をセットでまとめていきます。
以下、第Ⅰ章から順番に始めますね。

📘 今回は 第Ⅰ章「同一型・比較型」からスタートします。

──────────────────────

📗 第Ⅰ章：同一型・比較型の不定方程式

これは、n! と他の階乗・整数・差・比などを比較する最も基本的なパターンです。

例題とその解説を見てみましょう！

◆ 例題1.1（初級）：
次の方程式を満たす自然数 n, m をすべて求めよ。

$$
n! = m!
$$

🧠 解法：

* 明らかに両辺が等しいなら、n = m。
* よって解は：n = m

✓ 結論：すべての自然数 n に対して、m = n のとき成立。

──────────────────────

◆ 例題1.2（中級）：
次の方程式を満たす自然数 n, m をすべて求めよ。

$$
n! = m
$$

🧠 解法：

* m が階乗数であるかどうかを調べればよい。
* 小さい n に対して調査：

  * 1! = 1
  * 2! = 2
  * 3! = 6
  * 4! = 24
  * 5! = 120
  * 6! = 720
  * …
* 例えば m = 720 なら n = 6

✓ テクニック：階乗数を逆に調べるには、ループで n! を増加させながら m と比較。

──────────────────────

◆ 例題1.3（中上級）：
次の方程式を満たす自然数 n, m をすべて求めよ。

$$
\frac{n!}{m!} = k \quad \text{（k は自然数）}
$$

🧠 解法：

* $\dfrac{n!}{m!} = \dfrac{n(n-1)\cdots(m+1)}{1}$（n ≥ m と仮定）
* つまり、(m+1)〜n までの積 = k
* この式は整数になる ⇔ m ≤ n
* 逆に k が与えられていて、階乗商が整数かどうかを調べる問題としても出る。

🧩 応用問題の例：

$$
\frac{n!}{(n-3)!} = 120 \quad \Rightarrow \quad n(n-1)(n-2) = 120
$$

→ 展開して立式し、解を出す（三次方程式）。

✓ ポイント：階乗の比は「連続整数の積」に変換して考える。

──────────────────────

◆ 例題1.4（上級）：
次の方程式を満たす自然数 n, m をすべて求めよ。

$$
n! - m! = 96
$$

🧠 解法方針：

* n > m と仮定して、両辺を具体的に試す。
* 小さい n について差を調べる：

  * 5! - 4! = 120 - 24 = 96 ← 成立！

他の組み合わせは？

* 6! - 5! = 720 - 120 = 600 ≫ 96（差が急激に増加）
  → よって他に解はない。

✓ テクニック：階乗は急成長するため、差が一定になるのは小さい範囲のみ。

──────────────────────

📎 補足：この型で使う数学的道具

* 基本の階乗の定義：n! = n×(n−1)×…×1
* 整数性の判定（分数が整数かどうか）
* 桁数・増加の急激さに注目した探索（差・比はすぐに不成立になる）

──────────────────────

📘 次回：第Ⅱ章「階乗と累乗の比較型」

内容予定：

* 階乗 = 累乗
* 階乗 = 累乗 ± 1
* 完全冪かどうか（Legendre の定理の活用）

もし、例題付きのPDF形式などが欲しければ、あとでまとめて出力もできますよ！
次の章に進めてよいですか？

---
---

了解！それでは続けて…

──────────────────────

📘 第Ⅱ章：階乗と累乗の比較型（階乗 = 累乗 の不定方程式）

これは、階乗とべき乗（mⁿ や nᵏ）を等式で結ぶタイプの方程式です。
成長速度の違いが鍵になるため、素因数分解や漸近評価が重要になります。

──────────────────────

◆ 例題2.1（中級）：
次の方程式を満たす自然数 n, m をすべて求めよ。

$$
n! = m^2
$$

🧠 解法の方針：

* 左辺は階乗、右辺は完全平方数。
* n! が平方数になるのは「すべての素因数の指数が偶数」のとき。

👓 使う道具：Legendre の定理

$$
\nu_p(n!) = \sum_{k=1}^{\infty} \left\lfloor \frac{n}{p^k} \right\rfloor
$$

（n! における素数 p の指数）

📌 実際に調べる：

* 1! = 1 = 1² → OK
* 2! = 2 → NG
* 3! = 6 → NG
* 4! = 24 → NG
* 5! = 120 → NG
* 6! = 720 → NG
* 7! = 5040 → NG
* 8! = 40320 → NG
* 9! = 362880 → NG
* 10! = 3628800 → NG

→ 小さいものを調べても、1! しか該当しない。

✅ 解：n = 1 のとき、m = 1 のみ。

──────────────────────

◆ 例題2.2（上級）：
次の方程式を満たす自然数 n, m をすべて求めよ。

$$
n! = m^n
$$

🧠 解法の方針：

* 両辺が n のべきになっているので、Stirling の近似を使って考える。

📌 Stirling の公式（近似）：

$$
n! \sim \sqrt{2\pi n} \left(\frac{n}{e}\right)^n
$$

したがって、

$$
\frac{n!}{n^n} \sim \sqrt{2\pi n} \cdot \left(\frac{1}{e}\right)^n
\to 0 \text{（n → ∞ のとき）}
$$

→ 結論：n! < nⁿ  なので、n! = mⁿ となることはごく限られる。

🔍 実際に小さい n で試す：

* n = 1: 1! = 1 = 1¹ → OK
* n = 2: 2! = 2, 2² = 4 → NG
* n = 3: 6, 3³ = 27 → NG
* n = 4: 24, 4⁴ = 256 → NG

→ 以後はどんどん差が開くため、他に解はなし。

✅ 解：n = 1, m = 1 のみ。

──────────────────────

◆ 例題2.3（未解決問題：Brocard–Ramanujan）：
次の方程式の自然数解 (n, m) をすべて求めよ：

$$
n! + 1 = m^2
$$

🧠 現時点で知られている解は：

* n = 4 → 4! + 1 = 24 + 1 = 25 = 5²
* n = 5 → 5! + 1 = 120 + 1 = 121 = 11²
* n = 7 → 7! + 1 = 5040 + 1 = 5041 = 71²

💥 未解決：この3つ以外に解が存在するかは分かっていません（2024年現在でも未解決）

このような問題は、Pell 方程式や高次ディオファントス方程式と関わりがあり、理論的にも深いです。

──────────────────────

◆ 例題2.4（中級〜上級）：
次の方程式を満たす自然数 n, m をすべて求めよ。

$$
n! = 2^m
$$

🧠 解法の方針：

* 階乗が 2 の冪になるためには、n! に奇数の素因数が含まれてはいけない。
* つまり、n! の素因数がすべて 2 である必要がある。

📌 試してみる：

* 1! = 1 → OK（= 2⁰）
* 2! = 2 → OK（= 2¹）
* 3! = 6 → NG（3 が素因数）
* 以後すべて NG

✅ 解：n = 1, 2 のみ

──────────────────────

📎 この章で使う重要な数学ツール：

* Legendre の定理：n! における素因数の指数を正確に求める
* Stirling の近似：n! の成長を近似評価して不等式を立てる
* 素因数分解：n! = m^k なら、n! に含まれるすべての素因数の指数は k の倍数でなければならない
* 整数論の知識：平方数・立方数の判定

──────────────────────

📘 次回：第Ⅲ章「階乗と素数の関係型」

予定内容：

* n! ± 1 が素数になるか？（階乗素数）
* Wilsonの定理との関係
* 素数 p に対して (p − 1)! ≡ −1 mod p
* 階乗と素数列の交差（例：n! + 1 = pₖ など）

続けて進めてOKなら教えてください！

---
---

了解！
では続けて──

──────────────────────

📘 第Ⅲ章：階乗と素数の関係型（階乗 ± 1 = 素数 など）

このカテゴリでは、階乗に対して ±1 したものが素数になるかどうかを問う問題、あるいは階乗と素数の合同関係を扱います。
整数論（とくに合同式・Wilsonの定理）が中心になります。

──────────────────────

◆ 例題3.1（中級）：
次の方程式を満たす自然数 n をすべて求めよ。

$$
n! + 1 = p \quad（p は素数）
$$

🧠 解法方針：

* 小さい n について順に試す（経験的に！）

調査：

* 1! + 1 = 2 → 素数：OK
* 2! + 1 = 3 → OK
* 3! + 1 = 7 → OK
* 4! + 1 = 25 → NG
* 5! + 1 = 121 → NG
* 6! + 1 = 721 → NG
* 7! + 1 = 5041 → NG（偶然 71² = 5041）

✅ 結論：n = 1, 2, 3 のときだけ、n! + 1 が素数になる。

このような素数は「階乗素数（factorial primes）」と呼ばれます。
一般に、n! ± 1 が素数になることは極めて稀です。

──────────────────────

◆ 例題3.2（中級）：
次の方程式を満たす自然数 n をすべて求めよ。

$$
n! - 1 = p \quad（p は素数）
$$

🧠 解法方針：同様に具体的に調査

* 2! - 1 = 1 → NG
* 3! - 1 = 5 → OK
* 4! - 1 = 23 → OK
* 5! - 1 = 119 → NG
* 6! - 1 = 719 → OK（素数！）

→ ここまではいくつか出現するが、n が増えると出現しにくくなる。

✅ n = 3, 4, 6 で OK

💡 コメント：
n! ± 1 が素数になるかは、現在でも予測困難な問題であり、いくつかの例以外に法則性が見つかっていません。

──────────────────────

◆ 例題3.3（上級）：
素数 p に対して次の合同を示せ：

$$
(p - 1)! \equiv -1 \pmod{p}
$$

🧠 Wilsonの定理

定理：p が素数 ⇔ (p − 1)! ≡ −1 mod p

証明方針（概略）：

* mod p での逆元のペアを組むと、1×2×…×(p−1) の積が −1 に帰着される。
* 逆に、この合同が成り立つなら p は素数でなければならない。

✅ コメント：

* この定理は「素数判定のための必要十分条件」だが、計算量的に実用的ではない。
* ただし理論的には非常に重要。

──────────────────────

◆ 例題3.4（中上級）：
p が素数のとき、次を示せ：

$$
(p - k)! \equiv 0 \pmod{p} \quad（1 ≤ k ≤ p−2）
$$

🧠 解説：

* p > k → (p−k)! は p より小さい整数の積なので、p で割り切れないように見える。
* でも p が (p−k)! に含まれる因数になることがないので、実は
  → (p−k)! ≢ 0 mod p

逆に、p ≤ (p−1)! なら、(p−1)! ≡ −1 mod p（Wilson）

この例は応用的な設定としての位置付け。

──────────────────────

📎 この章で使う重要な数学ツール：

* Wilsonの定理：素数の必要十分条件
* n! ± 1 の素数性：階乗素数 factorial primes（実験的探索が主）
* 合同式の基本的な性質（mod p）
* 素数列との一致（pₙ = n! ± 1 のような問題）

──────────────────────

📘 次回：第Ⅳ章「階乗と線形関係型（和・差・等式）」

予定内容：

* n! = m! + k!
* n! = a + b（和型）
* n! − m! = c（差型）
* n! = ax + b のような形

必要があれば、Python を使って階乗素数や n! = m² + 1 の探索コードも書けます！
続けてよければ「OK」とどうぞ。

---
---

了解！
それでは続けて──

──────────────────────

📘 第Ⅳ章：階乗と線形関係型（和・差・等式）

この章では、階乗を他の階乗や整数の「和」「差」「線形結合」として表す方程式を扱います。
方程式としては単純そうに見えますが、実は解が非常に限られたり、場合によっては未解決問題と関わったりもします。

──────────────────────

◆ 例題4.1（中上級）：
次の方程式を満たす自然数 n, m, k をすべて求めよ。

$$
n! = m! + k!
$$

🧠 解法方針：

* m, k < n と仮定して、右辺が左辺より小さい。
* 小さい数で具体的に調べていく。

調査：

* n = 5 → 5! = 120

  * 4! = 24 → 120 − 24 = 96 → 96 ≠ 他の階乗
  * 3! = 6 → 120 − 6 = 114 → NG
* n = 6 → 720

  * 5! = 120 → 720 − 120 = 600 → NG
  * 4! = 24 → 696 → NG

📌 実際に見つかっている解：

* n = 5, m = 4, k = 4 → 5! = 4! + 4!
  → 120 = 24 + 24 = 48 ← 不成立

* 唯一知られている小さな自然数解：

  $$
  9! = 8! + 7! = 40320 + 5040 = 45360
  $$

✅ 解のひとつ：n = 9, m = 8, k = 7（順序違いも含む）

💡 コメント：
m! + k! が n! に一致することは非常に稀。特に m ≠ k の場合には計算がやや複雑に。

──────────────────────

◆ 例題4.2（初級）：
次の方程式を満たす自然数 n をすべて求めよ。

$$
n! = a + b \quad（a, b は自然数）
$$

🧠 解法：

* 任意の自然数 n に対して、a = 1, b = n! − 1 で OK
* つまりこの方程式は常に解を持つ

✅ 結論：常に解が存在（ただし a, b の制限があると別）

発展形：

* a, b が共に階乗数
* a, b が平方数
* a = b のような対称条件付き

──────────────────────

◆ 例題4.3（中級）：
次の方程式を満たす自然数 n, m をすべて求めよ。

$$
n! - m! = k \quad（k が定数）
$$

例：k = 96 のとき

🧠 解法：

* 差が一定 ⇒ 小さい n, m について調査

例：

* 5! − 4! = 120 − 24 = 96 → OK
* 6! − 5! = 720 − 120 = 600 → NG
* 7! − 6! = 5040 − 720 = 4320 → NG（大きくなりすぎ）

✅ 結論：n = 5, m = 4 のとき唯一解

💡 ポイント：階乗の増加速度が急なので、差が固定のときは解は有限個しかない。

──────────────────────

◆ 例題4.4（上級）：
次の方程式の自然数解をすべて求めよ。

$$
n! = 2a + 1
$$

🧠 解法：

* n! が奇数である ⇔ n = 1 だけ（n ≥ 2 なら偶数）

よって 2a + 1 = 奇数 ⇔ n! = 奇数 ⇒ n = 1 → 1! = 1 → 2a + 1 = 1 ⇒ a = 0

✅ 解：n = 1, a = 0 のみ

📌 発展的に：
n! = ax + b のような形で a, b, x に整数条件をつけると、ディオファントス方程式（整数解方程式）になる。

──────────────────────

📎 この章で使う数学的テクニック：

* 小さな n からの直接代入（数値実験が有効）
* 階乗の成長速度に注目（n! − m! などは大きくなる）
* 対称性・変数入れ替えの利用（m! + k! = n!）
* パターン認識（例：連続した階乗差）

──────────────────────

📘 次回：第Ⅴ章「階乗と他の数列の関係型」

予定内容：

* フィボナッチ数との一致：n! = Fm
* 階乗 = 三角数、平方数など
* n! = pₖ（pₖ は k 番目の素数）といった型

次も進めてよければ「OK」とだけ送ってください！
必要なら、これまでの章をPDFとしてまとめることも可能です。

---
---

了解！
それでは続けて──

──────────────────────

📘 第Ⅴ章：階乗と他の数列の関係型（フィボナッチ・素数列・平方数 等）

この章では、階乗が他の既知の数列（フィボナッチ数列・三角数・素数列など）の項に一致するかどうか、あるいは関係式を満たすかを問う問題を扱います。
本質的には「数列の成長速度」や「一意性・冗長性」の比較になります。

──────────────────────

◆ 例題5.1（中級）：
次の方程式を満たす自然数 n, m をすべて求めよ。

$$
n! = F_m \quad（Fₘ は m 番目のフィボナッチ数）
$$

🧠 解法方針：

フィボナッチ数（Fₘ）は、指数関数的に増加
階乗（n!）も急増
→ 小さい範囲で一致する項があるかを調べる

調査：

| n | n!  | Fₘ 値が一致するか？ |
| - | --- | ----------- |
| 1 | 1   | F₁ = 1 ✅    |
| 2 | 2   | F₃ = 2 ✅    |
| 3 | 6   | F₅ = 5 ❌    |
| 4 | 24  | F₉ = 34 ❌   |
| 5 | 120 | F₁₁ = 89 ❌  |

✅ 一致があるのは：

* n = 1, F₁ = 1
* n = 2, F₃ = 2

その他には見つからない（急激な差が開く）

💡 コメント：
この手の問題では「漸近的な成長の差」が重要。指数近似などを使えば、解が有限であることも理論的に示せる。

──────────────────────

◆ 例題5.2（中級）：
次の方程式を満たす自然数 n, m をすべて求めよ。

$$
n! = T_m \quad（Tₘ は m 番目の三角数 = 𝑚(𝑚+1)/2）
$$

🧠 解法方針：

* 三角数は2次関数的な成長（緩やか）
* 階乗は指数的に成長（急激）

調査：

* T₁ = 1 → n! = 1 ⇒ n = 1 ✅
* T₃ = 6 → n = 3 ⇒ 3! = 6 ✅
* T₄ = 10 → NG
* T₅ = 15 → NG
* T₆ = 21 → NG
* T₇ = 28 → NG
* T₈ = 36 → NG
* T₉ = 45 → NG
* T₁₀ = 55 → NG
* T₁₁ = 66 → NG
* T₁₂ = 78 → NG
* T₁₃ = 91 → NG
* T₁₄ = 105 → NG
* T₁₅ = 120 → ✅ 5! = 120

よって解：

* n = 1, m = 1
* n = 3, m = 3
* n = 5, m = 15

✅ 以上のみ（差がすぐ開く）

──────────────────────

◆ 例題5.3（上級）：
次の方程式を満たす自然数 n, k をすべて求めよ。

$$
n! = p_k \quad（p_k は k 番目の素数）
$$

🧠 解法：

* 素数列：2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, …

調べてみる：

* 1! = 1 → NG
* 2! = 2 → ✅ p₁ = 2
* 3! = 6 → NG
* 4! = 24 → NG
* 5! = 120 → NG

→ 階乗はすぐに合成数になる

✅ 解：n = 2, k = 1 のときのみ一致

──────────────────────

◆ 例題5.4（やや発展）：
次の方程式の自然数解をすべて求めよ。

$$
n! = x^2 + y^2
$$

🧠 解法方針：

* n! が2つの平方数の和になっているか判定
* 整数論で、ある数が2つの平方和で表せるかどうかの判定法がある

例：

* n = 5 → 5! = 120 = 2² + 10² ✅
* n = 6 → 720 = 24² + 12² ✅
* n = 7 → 5040 = 70² + 20² ✅

このような問題は、理論（平方和定理）で解析できるが、一般に完全な分類は難しい。

──────────────────────

📎 この章で使う数学的道具：

* 数列の漸近評価（成長速度の比較）

  * 階乗：n! ≈ (n/e)^n（Stirling近似）
  * フィボナッチ：Fₙ ≈ φⁿ / √5（φ = 黄金比）
* 数列の逆像探索（与えられた数が数列に属するか）
* 平方和定理（a² + b² = N となる整数の存在性）

──────────────────────

📘 次回：第Ⅵ章「階乗と合同条件・剰余系の関係」

予定内容：

* Wilsonの定理（復習含む）
* (n! ≡ a mod p) のタイプ
* n! がある剰余類に属する条件
* 中国剰余定理との組み合わせ問題

OKなら「ok」とだけ送ってください！
そろそろPDF形式 or 問題集形式にしてもいいかもしれません（必要であれば）

---
---

了解！
それではいよいよラスト──

──────────────────────

📘 第Ⅵ章：階乗と合同条件・剰余系の関係

この章では、n! を mod p（素数）や他の整数で割ったときの剰余、合同式に関する問題を扱います。
とくに、Wilsonの定理や中国剰余定理と組み合わせることで、興味深い結果や方程式が得られます。

──────────────────────

◆ 例題6.1（中級）：
素数 p に対して次を証明せよ：

$$
(p - 1)! \equiv -1 \pmod{p}
$$

🧠 解説：Wilsonの定理（再掲）

* 定理：p が素数 ⇔ (p − 1)! ≡ −1 mod p
* 逆も成り立つ
* 合同式を使って証明できる

📌 応用：

* (p−1)! + 1 ≡ 0 mod p ⇔ p ∣ (p−1)! + 1

この形は、階乗素数や合同方程式のベースになる。

──────────────────────

◆ 例題6.2（中〜上級）：
n! ≡ 0 mod p となる n の最小値を求めよ（p は素数）

🧠 解法：

* 階乗に p が含まれる ⇔ n ≥ p
* よって最小の n は n = p

✅ 結論：n = p で初めて n! ≡ 0 mod p

──────────────────────

◆ 例題6.3（発展）：
次の不定方程式を考える：

$$
n! \equiv a \pmod{m}
$$

🧠 解法方針：

* m の素因数分解に注目
* n ≥ m のとき、n! ≡ 0 mod m（すべての素因数を含むため）
* よって有限個の n に対してしか n! ≡ a mod m の解は存在しない

例：

* m = 6, a = 4
* 調べる：1! = 1 → NG, 2! = 2 → NG, 3! = 6 → 0 → NG, 4! = 24 ≡ 0 → NG
* 一致するものがなければ解なし

✅ ポイント：n ≥ m なら n! ≡ 0 mod m に「収束」してしまう

──────────────────────

◆ 例題6.4（中上級）：
次を満たす最小の n を求めよ：

$$
n! \equiv -1 \pmod{n}
$$

🧠 解法：

* これは Wilson の定理の逆向き
* (n − 1)! ≡ −1 mod n ⇔ n は素数
* ならば (n − 1)! ≡ −1 mod n ⇒ n が素数であることを逆に使うと：

n! ≡ −1 mod n ⇒ n が素数で、n! ≡ −1 ⇒ 成立しない！

実際に試すと：

* n = 1: 1! = 1 ≡ 0 → NG
* n = 2: 2! = 2 ≡ 0 → NG
* n = 3: 6 ≡ 0 → NG
* n = 5: 120 ≡ 120 ≡ 0 mod 5

→ 成立するものはないように見える
より正確には、階乗がその元の値で割り切れる場合（= 0 mod n）にしかならないので、n! ≡ −1 mod n が成立する自然数 n は存在しない（1 ≤ n ≤ 数千調査で不成立）

✅ 結論：該当なし、または非常に特異な n のみ（研究対象）

──────────────────────

📌 この章で使う道具：

* Wilsonの定理
* 合同式の基本性質
* 階乗のmod評価：n ≥ m ⇒ n! ≡ 0 mod m
* 中国剰余定理（複数条件の解を合成）

例題（応用）：

$$
n! ≡ 1 \pmod{5} \quad \text{かつ} \quad n! ≡ 2 \pmod{7}
$$

→ 各 mod 条件の下で n を列挙し、CRT で合成可能

──────────────────────

✅ 全6章：完結しました！

以下の構成でまとめてあります：

| 章   | タイトル     | 内容概要                      |
| --- | -------- | ------------------------- |
| 第Ⅰ章 | 同一型・比較型  | n! = m!, n! = m などの基本型    |
| 第Ⅱ章 | 階乗 = 累乗型 | n! = m², mⁿ, mⁿ ± 1 型     |
| 第Ⅲ章 | 階乗と素数の関係 | n! ± 1 = p 型、Wilsonの定理    |
| 第Ⅳ章 | 和・差・線形型  | n! = m! + k!, n! − m! = c |
| 第Ⅴ章 | 他の数列との比較 | フィボナッチ、三角数、素数列            |
| 第Ⅵ章 | 合同条件・剰余型 | mod p における階乗の性質           |

📄 オプション：

* 各章をPDFでまとめて「解説集」に
* 章末問題＋解答つきの「問題集」形式に
* LaTeXコード化してプレゼン資料に
* Pythonコードで n! = m² ± 1 などを探索するツール作成

👇 やりたい形式を教えてください！
たとえば：

* 「PDFにまとめて」
* 「問題集形式でまとめて」
* 「LaTeXコードで出して」
* 「Python探索コードちょうだい」

など、自由に指示ください。

---
---

