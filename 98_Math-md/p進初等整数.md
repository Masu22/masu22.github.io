# 京都大特色 2023 問題
なかけんノート  
https://math.nakaken88.com/problem/kyoto-u-t-2023-4/

>$p$を3以上の素数、$a$を整数とする。  
このとき、$p^2$ 以上の整数 $n$ であって、  
>$${}_n C_{p^2} \equiv a \pmod {p^3}$$
>を満たすものが存在することを示せ。

<br>

---

## 誤読？？
リンク先の問題は **京都大学 2023年度 前期 理系 第4問** であり、確率に関する問題です。  

### **問題概要**
- \( n \) 枚の硬貨があり、それぞれ独立に表が出る確率が \( p \) である。
- これらを投げたとき、表の出る枚数を \( X \) とする。
- \( X \) が偶数である確率 \( P(X \text{ が偶数}) \) を求める。

### **解法のポイント**
1. **確率母関数を利用する方法**  
   - \( X \) は **二項分布** \( B(n, p) \) に従う。
   - 確率母関数（または母関数法）を使い、偶奇の確率を考える。

2. **期待値を使う方法**  
   - 各コインを \( \pm1 \) に符号化することで、偶数枚表が出る確率を計算する。

### **結論**
求める確率は  
\[
P(X \text{ が偶数}) = \frac{1 + (1 - 2p)^n}{2}
\]
特に、\( p = \frac{1}{2} \) の場合、対称性から \( P(X \text{ が偶数}) = \frac{1}{2} \) になる。
User
[File]: file-7BZ5GfsiguARU1FQFVBotp-C4052C8B-7D14-41B6-AB22-41CB53709F44.jpeg
この問題、難しいようです。どうやったら、この問題を思いつくのでしょうか？？
ChatGPT
この問題は二項係数の \( p \)-進評価に関するもので、特に **ルーカスの定理や Kummer の定理、Hensel の補題などの知識が鍵** になります。  

### **この問題を思いつく背景**
この問題を考案するには、以下のような視点が重要です。

1. **二項係数の合同式の性質**  
   - 二項係数 \( \binom{n}{k} \) を素数 \( p \) のべき乗で評価する理論は、数論ではよく出てきます。  
   - 例えば、**ルーカスの定理** や **Kummer の定理** を考えると、二項係数の \( p \)-進評価を調べるのが自然な流れです。  

2. **特定の合同式を満たす \( n \) の存在を示す問題**  
   - この問題では \( p^2 \) 以上の整数 \( n \) を探しています。  
   - つまり、「ある程度大きい \( n \) に対して、特定の合同式を満たす \( n \) が必ず存在する」ことを示す問題と見ることができます。  
   - こうしたテーマは、**中国剰余定理や Hensel の補題** など、合同式の解の存在を示す手法と関わりが深いです。  

3. **数論的な問題を作る発想**  
   - 二項係数の性質を調べるとき、\( p^m \) での評価を考えることはよくあります。  
   - 特に \( p^2 \) 以上の \( n \) に対して特定の合同式を満たすものが存在することを示すのは、「大きな \( n \) の中に特定のパターンを持つものがあるか？」という発想から来ている可能性があります。  
   - これは組み合わせ論と数論の境界領域でよく出る考え方です。  

### **この問題の背後にある理論**
- **二項係数の \( p \)-進評価**  
  - Kummer の定理により、\( \binom{n}{p^2} \) が \( p^3 \) での合同式を満たすかを調べる発想。  
- **合同式の解の存在**  
  - Hensel の補題などを使って、ある \( n \) が存在することを示せるかどうかを考える。  
- **具体的な構成方法**  
  - ある \( n \) に対して \( \binom{n}{p^2} \equiv a \pmod{p^3} \) を満たすように、適切な \( n \) を構成する発想。  
  - 例えば \( n = p^2 + kp^3 \) のような形を考えると、特定の値を作りやすくなるかもしれない。

### **結論**
この問題を思いつくには、**二項係数の合同式に関する数論的な知識** を持ち、さらに **合同式の解の存在を示す問題の枠組み** を知っていることが重要です。  
「二項係数の \( p \)-進評価」に注目し、「ある条件を満たす \( n \) の存在を示す」という組み合わせで問題が作られていると考えられます。
User
解き方はわかる？？
ChatGPT
この問題を解くには、**二項係数の \( p \)-進評価** を調べ、適切な \( n \) を構成する必要があります。具体的には **Kummer の定理や Hensel の補題のアイデアを使う** のが有効です。  

---

## **方針**
与えられた合同式
\[
\binom{n}{p^2} \equiv a \pmod{p^3}
\]
を満たす \( n \) を見つけることが目標です。  

### **1. 二項係数の \( p \)-進評価**
二項係数の定義：
\[
\binom{n}{p^2} = \frac{n(n-1)\cdots(n-p^2+1)}{p^2!}
\]
分母には \( p^2! \) があり、これは \( p^2 \) を因数に持つため、分子が十分な \( p \) の倍数を持っていないと、\( p^3 \) での評価が難しくなります。

したがって、分子の \( p \)-進評価を調べることで、合同式を満たす \( n \) を探します。

---

### **2. \( n \) の選び方**
問題の条件として **\( n \) は \( p^2 \) 以上** の整数であればよいので、特定の形を考えます。

例えば、  
\[
n = p^2 + k p^3
\]
のような形を考えると、\( k \) をうまく選ぶことで合同式を満たせる可能性があります。

---

### **3. \( n = p^2 + k p^3 \) の場合の二項係数**
この形の \( n \) を使うと、
\[
\binom{n}{p^2} = \frac{(p^2 + k p^3)(p^2 + k p^3 - 1) \cdots (p^2 + k p^3 - p^2 +1)}{p^2!}
\]
と書けます。

ここで、**分母は \( p^2! \) なので、\( p^2 \) の倍数** を考えたときに、適切な \( k \) を選べば \( \binom{n}{p^2} \equiv a \pmod{p^3} \) になるようにできるはずです。

---

## **結論**
1. **\( n = p^2 + k p^3 \) の形を考える**  
2. **二項係数の \( p \)-進評価を調べる**  
3. **適切な \( k \) を選ぶことで合同式を満たすように調整する**  

この流れで **必ず存在することが示せる** はずです。
User
ルーカスの定理、kummer の定理、hensel の補題を使うと簡単に解ける？？
ChatGPT
ルーカスの定理、Kummer の定理、Hensel の補題を使うと、問題の本質を理解しやすくなりますが、それだけで即座に解決するわけではありません。ただし、これらのツールをうまく組み合わせることで、合理的なアプローチが見えてきます。  

---

### **1. ルーカスの定理の適用**
ルーカスの定理は、**二項係数の \( p \)-進合同式** を求める際に有効です。  

この定理によれば、\( n = n_k p^k + \dots + n_1 p + n_0 \)（\( p \) 進展開）と書くと、  
\[
\binom{n}{m} \equiv \binom{n_k}{m_k} \binom{n_{k-1}}{m_{k-1}} \cdots \binom{n_0}{m_0} \pmod{p}
\]
が成り立ちます。  

ここで、\( n \) は \( p^2 \) 以上なので、適切な \( n \) を選ぶことで、\( \binom{n}{p^2} \) の \( p^3 \) での評価がコントロールできる可能性があります。  

---

### **2. Kummer の定理の適用**
Kummer の定理は、二項係数 \( \binom{n}{m} \) が **どれくらいの \( p \) のべきで割れるか** を教えてくれます。  

この定理によると、\( v_p(\binom{n}{m}) \)（\( p \) の指数）は、  
\[
\text{\( n \) と \( m \) の \( p \) 進展開を比べ、上からの桁で借り下げが発生する回数の総和}
\]
によって決まります。  

ここで、\( m = p^2 \) を固定して \( n \) を調整することで、\( \binom{n}{p^2} \equiv a \pmod{p^3} \) を満たすようにできるかを考えます。  

---

### **3. Hensel の補題の適用**
Hensel の補題は、**合同式の解を高次のべきに持ち上げる** ための道具です。  

もしある \( n \) について
\[
\binom{n}{p^2} \equiv a \pmod{p^2}
\]
が成り立つなら、適切な修正を加えることで、  
\[
\binom{n'}{p^2} \equiv a \pmod{p^3}
\]
を満たすような \( n' \) を構成できる可能性があります。  

---

## **結論**
ルーカスの定理で **\( p \)-進係数の形を簡単に** し、Kummer の定理で **\( p \)-進評価** を調べ、Hensel の補題を使って **高次の剰余類に持ち上げる** という戦略をとると、比較的スムーズに解けるはずです。  

ただし、具体的な \( n \) の構成には多少の計算が必要になるため、**「即座に簡単に解ける」わけではないが、考え方を整理するのに有効** という感じですね。
User
それぞれの定理、補題の概略を教えて！
ChatGPT
それぞれの定理・補題の概略を説明します。  

---

## **1. ルーカスの定理（Lucas' Theorem）**  
**二項係数の \( p \)-進合同式を求めるための定理** で、次のように表されます。  

**定理の主張**  
素数 \( p \) に対して、\( n, m \) の \( p \) 進展開を  
\[
n = n_k p^k + n_{k-1} p^{k-1} + \dots + n_1 p + n_0
\]
\[
m = m_k p^k + m_{k-1} p^{k-1} + \dots + m_1 p + m_0
\]
とすると、二項係数の合同式が
\[
\binom{n}{m} \equiv \binom{n_k}{m_k} \binom{n_{k-1}}{m_{k-1}} \cdots \binom{n_1}{m_1} \binom{n_0}{m_0} \pmod{p}
\]
で与えられる。  

**ポイント**
- 係数 \( n_i \) が \( m_i \) より小さいときにのみ \( \binom{n_i}{m_i} \) が 0 でないため、この式が成り立つ。  
- これを使うと、二項係数の \( p \)-進評価が簡単に求められる。  

**例**  
\( n = 10, m = 3 \), 素数 \( p = 5 \) の場合  
- \( 10 = 2 \times 5^1 + 0 \times 5^0 \)  
- \( 3 = 0 \times 5^1 + 3 \times 5^0 \)  

ルーカスの定理より、  
\[
\binom{10}{3} \equiv \binom{2}{0} \binom{0}{3} \equiv 1 \times 0 = 0 \pmod{5}
\]  
よって \( 5 \) で割り切れることがわかる。  

---

## **2. Kummer の定理（Kummer's Theorem）**  
**二項係数がどれくらいの \( p \) のべきを含むか（\( p \)-進評価）を決める定理**。  

**定理の主張**  
\( n, m \) の \( p \) 進展開において、\( n - m \) を引いたときに発生する **「桁借りの回数」** が、\( p \)-進指数を決める。つまり、
\[
v_p \left( \binom{n}{m} \right) = \text{桁借りの回数}
\]
が成り立つ。  

**ポイント**  
- 「桁借りの回数」が多いほど \( p \)-進指数が大きくなる。  
- 逆に桁借りが少ないと、二項係数の \( p \)-進指数が小さくなり、合同式が成り立つ可能性が増える。  

**例**  
\( n = 10, m = 3 \), \( p = 5 \) の場合  
\[
10 = 2 \times 5^1 + 0 \times 5^0, \quad 3 = 0 \times 5^1 + 3 \times 5^0
\]
\[
10 - 3 = (2 - 0)5^1 + (0 - 3)5^0
\]
ここで \( 0 - 3 \) は桁借りが発生するため、桁借りの回数は 1 回。  
よって
\[
v_5 \left( \binom{10}{3} \right) = 1
\]
となる。  

---

## **3. Hensel の補題（Hensel's Lemma）**  
**数論的な合同式の解を高次の \( p \) べきに持ち上げるための補題**。  

**定理の主張**  
ある素数 \( p \) に対して、多項式 \( f(x) \) の解 \( x_0 \) が
\[
f(x_0) \equiv 0 \pmod{p}
\]
を満たし、かつ
\[
f'(x_0) \not\equiv 0 \pmod{p}
\]
ならば、この解を \( p^2 \), \( p^3 \) など高次のべきに持ち上げられる。つまり、ある \( x_1 \) が存在して
\[
f(x_1) \equiv 0 \pmod{p^2}
\]
が成り立つように拡張できる。  

**ポイント**  
- 低次の合同式の解から、高次の合同式の解を構成できる。  
- **「合同式の持ち上げ」が可能かどうかを判定するのに便利**。  

**例**  
\[
x^2 - 2 \equiv 0 \pmod{3}
\]
の解を考える。  
\( x_0 = 1 \) は \( 1^2 - 2 = -1 \equiv 0 \pmod{3} \) を満たす。  
\( f'(x) = 2x \) なので、\( f'(1) = 2 \not\equiv 0 \pmod{3} \)。  
したがって、Hensel の補題を適用して、高次の解 \( x_1 \equiv 1 \pmod{9} \) を持ち上げられる。  

---

## **まとめ**
| 定理/補題 | 役割 | 重要ポイント |
|-----------|------|------------|
| **ルーカスの定理** | 二項係数の \( p \)-進合同式 | \( p \) 進展開を使って二項係数の値を求める |
| **Kummer の定理** | 二項係数の \( p \)-進評価 | 桁借りの回数で \( p \)-進指数を決定 |
| **Hensel の補題** | 合同式の解の持ち上げ | 低次の合同式から高次の解を構成可能 |

**問題への適用**  
- ルーカスの定理を使って \( \binom{n}{p^2} \) の \( p \) 進評価を調べる  
- Kummer の定理を使って、どの \( n \) を選べば良いかを考える  
- Hensel の補題を使って、\( p^3 \) まで解を持ち上げる  

これで、**「必ず適切な \( n \) が存在する」ことを示せる** という流れになります。
User
Kummerの定理の式が消えちゃってる！桁借りは何？
ChatGPT
Kummer の定理に関する式が消えてしまったようなので、改めて整理して説明します。  

---

### **Kummer の定理（Kummer's Theorem）**  
**主張：**  
素数 \( p \) に対し、二項係数 \( \binom{n}{m} \) の \( p \)-進指数 \( v_p \)（すなわち、\( p \) で割り切れる回数）は、  
\[
v_p \left( \binom{n}{m} \right) = \text{「\( n - m \) を引いたときの桁借りの回数」}
\]  
で求められる。  

---

### **桁借りの意味**  
「桁借り」とは、**\( n - m \) を計算するときに、ある桁で数が不足して上の桁から借りてくる回数** のこと。  
具体例で説明します。  

#### **例 1：\( n = 10, m = 3 \), \( p = 5 \) の場合**
1. \( n = 10 \), \( m = 3 \) を \( p = 5 \) 進展開すると：
   \[
   10 = 2 \times 5^1 + 0 \times 5^0
   \]
   \[
   3 = 0 \times 5^1 + 3 \times 5^0
   \]

2. **引き算をすると：**
   \[
   10 - 3 = (2 - 0)5^1 + (0 - 3)5^0
   \]
   - \( 0 - 3 \) は負になるので、**桁借りが発生！**
   - したがって「桁借りの回数」は **1回**。

3. **結論**  
   \[
   v_5 \left( \binom{10}{3} \right) = 1
   \]
   → つまり、\( 5^1 \) で割り切れるが、\( 5^2 \) では割り切れない。

---

#### **例 2：\( n = 8, m = 2 \), \( p = 2 \) の場合**
1. \( 8 \) と \( 2 \) を \( 2 \) 進展開：
   \[
   8 = 1 \times 2^3 + 0 \times 2^2 + 0 \times 2^1 + 0 \times 2^0
   \]
   \[
   2 = 0 \times 2^3 + 0 \times 2^2 + 1 \times 2^1 + 0 \times 2^0
   \]

2. 引き算：
   \[
   8 - 2 = (1 - 0)2^3 + (0 - 0)2^2 + (0 - 1)2^1 + (0 - 0)2^0
   \]
   - \( 0 - 1 \) で **桁借り発生**！

3. **結論**  
   \[
   v_2 \left( \binom{8}{2} \right) = 1
   \]

---

### **Kummer の定理を問題に適用する**
問題では、  
\[
\binom{n}{p^2} \equiv a \pmod{p^3}
\]
を満たす \( n \) の存在を示す必要があります。  

**ステップ**
1. **ルーカスの定理で \( p \) 進展開を調べる**
2. **Kummer の定理で \( v_p \left( \binom{n}{p^2} \right) \) を調べる**
   - \( v_p \geq 3 \) となるような \( n \) を探す
3. **Hensel の補題で解を持ち上げる**

この流れで、問題を解決できます。
