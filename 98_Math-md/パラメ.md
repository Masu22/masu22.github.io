# 曲線のパラメータづけの判定
曲線がパラメータ付け（特に **有理パラメータ付け**）できるかどうかを代数幾何学的に判定するには、曲線の **種数 (genus)** を調べるのが基本的な方法です。  

### **1. 有理パラメータ付けとは？**
曲線 \( C \) が **有理パラメータ付け可能 (rationally parametrizable)** であるとは、次のような形で表されることを意味します：
\[
x = f(t), \quad y = g(t)
\]
ただし、\( f(t), g(t) \) は有理関数（分数式）であり、適切な開集合上で定義されるものとする。  
つまり、曲線が「有理関数によってパラメータ表示できる」なら、その曲線を**有理曲線 (rational curve)** と呼ぶ。

### **2. 種数による判定**
**代数幾何的に、曲線 \( C \) が有理パラメータ付け可能であることと、種数 \( g(C) = 0 \) であることが同値** である。  
ここで、種数 \( g(C) \) は、曲線の複素射影的なコンパクト化に対する基本的な不変量であり、大まかに言えば曲線の「トポロジー的な穴の数」を表す。

具体的に：
- **\( g = 0 \)** の場合、\( C \) は有理関数によるパラメータ付けが可能（有理曲線）。
- **\( g = 1 \)** の場合、楕円曲線（Weierstrassの標準形を持つ）。
- **\( g \geq 2 \)** の場合、代数曲線は一般に有理パラメータ付けできない（双有理同値な射影直線 \( \mathbb{P}^1 \) への写像が存在しない）。

### **3. 具体例**
#### **(1) 有理パラメータ付けできる曲線（種数 0）**
- 放物線 \( y = x^2 \) → \( x = t, y = t^2 \) によりパラメータ付け可能
- 円 \( x^2 + y^2 = 1 \) → \( x = \frac{1 - t^2}{1 + t^2}, y = \frac{2t}{1 + t^2} \) によりパラメータ付け可能
- 一般の 2 次曲線（適切な変数変換でパラメータ付け可能）

#### **(2) パラメータ付けできない曲線（種数 \( \geq 1 \)）**
- **楕円曲線** \( y^2 = x^3 + ax + b \) は種数 1 なので有理パラメータ付けはできないが、楕円関数によるパラメータ表示は可能。
- **高次代数曲線** \( y^2 = x^5 + x + 1 \) などは一般に種数 \( g \geq 2 \) を持ち、有理パラメータ付けは不可能。

### **4. 代数幾何学的視点**
- 曲線 \( C \) の **函数体 \( k(C) \)** が **有理函数体 \( k(t) \)** に同型（すなわち \( k(C) \cong k(t) \)）であれば、有理パラメータ付け可能。
- 代数曲線の **射影的な標準形** を考え、**双有理同値** な曲線が \( \mathbb{P}^1 \) であることを示せれば、有理パラメータ付けできる。
- **種数公式** を用いて種数を計算し、\( g = 0 \) であることを示せばよい。

### **まとめ**
代数幾何的に、曲線が有理パラメータ付け可能かどうかは **種数 \( g = 0 \) かどうか** で判定できる。種数が 1 以上なら有理パラメータ付けは不可能で、代わりに楕円関数などのより高度な方法が必要となる。

---
---

# 種数による判定の証明
### **有理パラメータ付け可能性と種数の関係の証明**
曲線が有理パラメータ付け可能であることと、その種数が 0 であることが同値であることを証明する。  

#### **主張**
射影代数曲線 \( C \) に対して、次は同値である：
1. \( C \) は有理関数によってパラメータ付けできる（すなわち、\( C \) は有理曲線である）。
2. \( C \) の関数体 \( k(C) \) は有理関数体 \( k(t) \) に同型である（すなわち、\( k(C) \cong k(t) \)）。
3. \( C \) の種数が 0 である（\( g(C) = 0 \)）。

---

### **(1) → (2)（パラメータ付け可能なら関数体が有理関数体）**
仮定より、\( C \) はある有理パラメータ付け
\[
x = f(t), \quad y = g(t), \quad \text{(その他の座標)}
\]
を持つとする。ただし、\( f, g, \dots \) は体 \( k \) 上の有理関数である。  
このとき、曲線 \( C \) の関数体 \( k(C) \) は \( t \) の有理関数体 \( k(t) \) によって生成されるので、
\[
k(C) = k(t)
\]
となる。したがって、\( k(C) \cong k(t) \) である。

---

### **(2) → (3)（関数体が有理関数体なら種数が 0）**
関数体が有理関数体 \( k(t) \) に同型である場合、曲線 \( C \) は **双有理的に** 射影直線 \( \mathbb{P}^1 \) に同型であることを意味する。  
これは、\( C \) が種数 0 の標準モデルを持つことを示すので、種数が 0 である。

**詳細な議論：**  
- 曲線の種数は、**双有理不変量** である（つまり、双有理変換では変わらない）。
- 射影直線 \( \mathbb{P}^1 \) の種数は 0 である。
- \( C \) と \( \mathbb{P}^1 \) が双有理同値ならば、\( C \) も種数 0 を持つ。

したがって、\( g(C) = 0 \) である。

---

### **(3) → (1)（種数が 0 ならパラメータ付け可能）**
種数が 0 であると仮定する。  
このとき、曲線 \( C \) の関数体 \( k(C) \) は **有理関数体 \( k(t) \) と同型であることを示す**。

この証明にはリーマン・ロッホの定理が有効である。リーマン・ロッホの定理より、種数が 0 ならば次数 1 の因子 \( P \) に対し、
\[
\dim H^0(C, \mathcal{O}(P)) = 2
\]
となるので、\( C \) 上の有理関数 \( x \) を適切に選べば、\( x \) が **有理関数体の生成元** となる（つまり \( k(C) = k(x) \) が成り立つ）。したがって、曲線 \( C \) は **双有理的に** \( \mathbb{P}^1 \) に同型であり、有理パラメータ付けが可能である。

---

### **結論**
以上により、以下の同値性が示された：
\[
C \text{ が有理パラメータ付け可能} \iff k(C) \cong k(t) \iff g(C) = 0.
\]

したがって、代数幾何的に曲線が有理パラメータ付け可能かどうかを判定するには、種数を計算すればよい。

---
---

# 種数の計算方法
種数 \( g \) の計算には、曲線の種類や方程式の形に応じていくつかの方法がある。ここでは代表的な方法を紹介する。  

---

## **1. 平面代数曲線の種数公式**
平面代数曲線 \( C \) が **非特異な射影曲線** で、既約な **次数 \( d \) の平面曲線**  
\[
F(x,y,z) = 0
\]
として与えられている場合、種数は次の公式で求められる：
\[
g = \frac{(d-1)(d-2)}{2} - \sum_{P} \delta_P.
\]
ここで、  
- \( \frac{(d-1)(d-2)}{2} \) は **非特異な場合の種数**（最大値）。  
- \( \delta_P \) は特異点 \( P \) の **δ 不変量**（局所的な寄与）。  

特異点がないならば、この公式で種数が直接計算できる。  

### **例1：楕円曲線**
Weierstrass 方程式
\[
y^2 = x^3 + ax + b
\]
は **次数 \( d = 3 \) の非特異平面曲線** なので、  
\[
g = \frac{(3-1)(3-2)}{2} = 1.
\]
したがって、**楕円曲線の種数は \( g = 1 \)** である。

### **例2：2 次曲線**
一般の 2 次曲線（円、楕円、放物線、双曲線）
\[
ax^2 + bxy + cy^2 + dx + ey + f = 0
\]
は \( d = 2 \) なので、
\[
g = \frac{(2-1)(2-2)}{2} = 0.
\]
よって、**すべての 2 次曲線は種数 0** であり、有理パラメータ付けが可能である。

---

## **2. リーマン・フルヴィッツの定理（被覆による種数計算）**
射影曲線 \( C \) から射影直線 \( \mathbb{P}^1 \) への有理写像
\[
\varphi: C \to \mathbb{P}^1
\]
がある場合、種数は **分岐データ** から求められる。リーマン・フルヴィッツの定理によると、次数 \( d \) の写像 \( \varphi \) に対して
\[
2g(C) - 2 = d(2g(\mathbb{P}^1) - 2) + \sum_{P \in C} (e_P - 1),
\]
ここで
- \( g(\mathbb{P}^1) = 0 \)（射影直線の種数）
- \( e_P \) は分岐指数（分岐点 \( P \) の重複度）

### **例3：楕円曲線の2重被覆**
楕円曲線 \( y^2 = x^3 + ax + b \) は
\[
\varphi: (x, y) \mapsto x
\]
によって射影直線 \( \mathbb{P}^1 \) への **2 重被覆** になっている。このとき、リーマン・フルヴィッツの定理を適用すると
\[
2g - 2 = 2(0 - 2) + \sum (e_P - 1).
\]
分岐点は \( x^3 + ax + b = 0 \) の 3 つの根で、それぞれの分岐指数は 2 なので
\[
\sum (e_P - 1) = 3(2-1) = 3.
\]
したがって、
\[
2g - 2 = -4 + 3 = -1 \implies g = 1.
\]
やはり楕円曲線の種数は 1 である。

---

## **3. 平面曲線の特異点を考慮した種数計算**
一般に、平面曲線 \( F(x,y,z) = 0 \) の特異点がある場合、次の補正を加える：
\[
g = \frac{(d-1)(d-2)}{2} - \sum_{P} \delta_P.
\]
- \( d \) は曲線の次数
- \( \delta_P \) は特異点 \( P \) の **δ 不変量**（局所的な種数の減少）

特異点が多いほど種数が小さくなる。

### **例4：特異な 3 次曲線（楕円曲線と有理曲線の違い）**
1. **非特異な場合（楕円曲線）**
   - \( y^2 = x^3 + ax + b \) は非特異なので、\( g = 1 \)。
   
2. **特異点を持つ場合（有理曲線）**
   - \( y^2 = x^3 \) では、原点 \( (0,0) \) が**尖点**になっており、\( \delta = 1 \)。
   - よって、
     \[
     g = \frac{(3-1)(3-2)}{2} - 1 = 1 - 1 = 0.
     \]
   - つまり、**特異な 3 次曲線は有理曲線になる**（種数 0）。

---

## **4. 射影曲線の標準束を用いた一般的な種数計算**
一般の **非特異射影曲線 \( C \) の種数** は、**標準因子 \( K_C \) の次数** によって与えられる：
\[
g = \dim H^0(C, K_C).
\]
- **次数が \( 2g - 2 \) であることを利用して計算することが多い。**
- たとえば、\( g = 0 \) ならば \( K_C \) は存在しないか、\( \mathbb{P}^1 \) のように負の次数を持つ。

---

## **まとめ**
| 曲線の種類 | 種数 \( g \) | 理由 |
|---|---|---|
| 直線・円・放物線・双曲線（2 次曲線） | 0 | \( g = \frac{(2-1)(2-2)}{2} = 0 \) |
| 非特異 3 次曲線（楕円曲線） | 1 | \( g = \frac{(3-1)(3-2)}{2} = 1 \) |
| 特異な 3 次曲線（例：尖点を持つ） | 0 | \( g = 1 - 1 = 0 \) |
| 4 次曲線（一般の非特異曲線） | 3 | \( g = \frac{(4-1)(4-2)}{2} = 3 \) |

種数を計算する方法は、曲線の次数や特異点の情報を活用することが重要である。

---
---

# 標準モデルとは？
### **標準モデルとは？**
代数曲線（特に射影代数曲線）を議論するとき、曲線の式の取り方にはさまざまな自由度がある。その中でも、できるだけ特異点がなく、曲線の「本質的な」形を反映するモデルを **標準モデル (canonical model)** という。  

具体的には、以下のような状況で標準モデルが定義される。

---

## **1. 射影曲線の標準モデル**
射影代数曲線 \( C \) の **標準モデル** とは、次の条件を満たすようなもの：
- **非特異**（すべての点が滑らかである）
- **既約**（1つの成分からなる）
- **射影的**（射影空間に埋め込まれている）
- **元の曲線と双有理同値**（関数体が変わらない）

つまり、「与えられた曲線に双有理同値で、最も単純な形を持つ非特異な射影曲線」を標準モデルと呼ぶ。

---

## **2. 例：平面代数曲線の標準モデル**
平面曲線 \( C \) が与えられたとき、その標準モデルを求める方法の1つは **特異点を解消すること（特異点解消）** である。

### **例 1: 特異な 3 次曲線**
たとえば、曲線
\[
C: y^2 = x^3
\]
は \( (0,0) \) で **尖点** を持っている（この点で微分が連続的に定義できない）。この曲線の標準モデルは、適切な変数変換や射影変換を施すことで、**非特異な Weierstrass 標準形**
\[
y^2 = x^3 + ax + b
\]
に変換できる。この形の曲線は楕円曲線であり、種数 \( g = 1 \) を持つ。

### **例 2: 二重線を持つ 3 次曲線**
\[
y^2 = x^3 + x^2
\]
は、原点で二重点（重複度2の特異点）を持つ。この場合、ブローアップ（blow-up）と呼ばれる手法を使って特異点を解消すると、**楕円曲線に変換できる**。このとき、解消後の曲線が標準モデルとなる。

---

## **3. 楕円曲線の標準モデル**
楕円曲線の標準モデルは、次の形で表される：
\[
y^2 = x^3 + ax + b
\]
ただし、\( 4a^3 + 27b^2 \neq 0 \)（特異点がないことを保証する条件）。

この形は **Weierstrass 標準形** と呼ばれ、任意の種数 1 の滑らかな代数曲線は適切な変数変換によってこの形に書き直せる。

---

## **4. 一般の曲線の標準モデル**
一般に、代数曲線の標準モデルは **種数 \( g \) によって異なる**：
- **\( g = 0 \)（有理曲線）**：\( \mathbb{P}^1 \) に双有理同値な曲線はすべて標準モデルとして **射影直線** \( \mathbb{P}^1 \) に一致する。
- **\( g = 1 \)（楕円曲線）**：Weierstrass 標準形 \( y^2 = x^3 + ax + b \) が標準モデル。
- **\( g \geq 2 \)（高種数曲線）**：大域的な幾何構造に依存するが、特に曲線が **極小モデル (minimal model)** を持つとき、それが標準モデルとなる。

高種数曲線では、**標準因子**（標準束の因子）を使って、射影空間への埋め込みを作ることができる。このような埋め込みを使った標準的な曲線を **正規モデル (normal model)** と呼ぶこともある。

---

## **5. まとめ**
- **標準モデルとは？**  
  → 与えられた曲線に双有理同値で、できるだけ「良い」性質（非特異、射影的）を持つ曲線。
- **標準モデルの求め方**
  1. **特異点の解消**（ブローアップなどを使う）
  2. **双有理変換を用いた単純化**
  3. **関数体を不変に保ちながら非特異な形にする**
- **種数別の標準モデル**
  - \( g = 0 \)（有理曲線）→ \( \mathbb{P}^1 \)
  - \( g = 1 \)（楕円曲線）→ Weierstrass 標準形 \( y^2 = x^3 + ax + b \)
  - \( g \geq 2 \) → 標準因子による射影埋め込みを考える

標準モデルを使うことで、曲線の種数や幾何構造を明確に把握できる。

---
---

# 標準因子とは？
### **標準因子 (canonical divisor) の定義**
代数曲線や一般の代数多様体の幾何学的性質を調べる上で、**標準因子 (canonical divisor)** は非常に重要な概念である。標準因子とは、曲線上の微分形式（正則な双対ベクトル場）を記述する因子であり、曲線の種数や射影埋め込みの性質を決定する役割を持つ。

---

## **1. 標準因子の定義**
滑らかな射影曲線 \( C \) 上の **標準因子** \( K_C \) は、曲線 \( C \) 上の **正則微分形式（双正則微分）** の消失・極を記録する因子である。

### **具体的には、次のように定義される：**
1. **正則微分形式 \( \omega \) の極を記録する因子**
   - 曲線上の正則な微分形式 \( \omega \) を考える。
   - \( \omega \) の極（pole）を持つ点 \( P \) での極の次数を \( \operatorname{ord}_P(\omega) \) とすると、標準因子は
     \[
     K_C = \sum_{P \in C} \operatorname{ord}_P(\omega) \cdot P
     \]
     という形の因子として定義される。
   - つまり、標準因子 \( K_C \) は、曲線上の双正則微分 \( \omega \) の極を追跡する **Cartier 因子** または **Weil 因子** である。

2. **標準線束に対応する因子**
   - 標準因子 \( K_C \) は、曲線の **標準束 (canonical sheaf) \( \Omega_C^1 \)** に対応する因子である。
   - つまり、因子 \( K_C \) に対応する **直線束 \( \mathcal{O}(K_C) \)** は **正則微分形式の空間** \( H^0(C, \Omega_C^1) \) を記述する。

---

## **2. 標準因子の次数**
代数曲線の標準因子 \( K_C \) の次数（因子の総和）は、曲線の種数 \( g \) を用いて
\[
\deg(K_C) = 2g - 2
\]
という公式で与えられる。これはリーマン・ロッホの定理から導かれる基本的な性質である。

### **例：種数ごとの標準因子の次数**
- **種数 \( g = 0 \)（有理曲線 \( \mathbb{P}^1 \)）**
  - 有理関数の正則微分はすべて **極を2つ持つ**（たとえば \( dt \) は \( t = \infty \) で 2 級の極を持つ）。
  - よって、標準因子は \( K_{\mathbb{P}^1} = -2P \) となり、\( \deg K_{\mathbb{P}^1} = -2 \) 。
  
- **種数 \( g = 1 \)（楕円曲線）**
  - 楕円曲線の標準因子の次数は \( \deg K_C = 2(1) - 2 = 0 \) であり、標準束は自明束になる。
  
- **種数 \( g = 2 \)（双有理同値な 2 次曲線）**
  - この場合、標準因子の次数は \( \deg K_C = 2(2) - 2 = 2 \) となる。

---

## **3. 標準因子の例**
### **(1) 射影直線 \( \mathbb{P}^1 \) の場合**
有理曲線 \( \mathbb{P}^1 \) の正則微分は \( dt \) などの形をしており、\( t = \infty \) で 2 級の極を持つため、
\[
K_{\mathbb{P}^1} = -2P_{\infty}.
\]
次数は \( -2 \) である。

### **(2) 楕円曲線の場合**
楕円曲線 \( y^2 = x^3 + ax + b \) では、正則微分は
\[
\omega = \frac{dx}{y}
\]
の形をしており、極を持たない。このため、
\[
K_C = 0.
\]
つまり、楕円曲線の標準因子は **ゼロ因子** であり、標準束は自明束になる。

### **(3) 種数 2 の曲線の場合**
二次曲線
\[
y^2 = f(x),
\]
（ただし \( f(x) \) は 5 次または 6 次の多項式）
の正則微分は
\[
\omega = \frac{dx}{y}
\]
の形をしており、極が2つ発生する。この場合、標準因子の次数は \( 2 \) になり、種数 2 であることが分かる。

---

## **4. 標準因子の役割**
### **(1) 曲線の種数を決定**
標準因子の次数が \( 2g - 2 \) であることを利用して、曲線の種数 \( g \) を計算できる。

### **(2) 標準束との関係**
標準因子 \( K_C \) は、曲線の **標準束 (canonical sheaf) \( \Omega_C^1 \)** に対応し、曲線の大域的な正則微分形式を記述する。
\[
H^0(C, \mathcal{O}(K_C)) = H^0(C, \Omega_C^1).
\]
この次元が曲線の種数 \( g \) に一致することがリーマン・ロッホの定理から導かれる。

### **(3) 曲線の埋め込み（標準写像）**
曲線 \( C \) の標準因子を使って、曲線を射影空間に埋め込むことができる。特に、種数 \( g \geq 2 \) の曲線に対して、標準因子による埋め込み
\[
\varphi: C \to \mathbb{P}^{g-1}
\]
を考えると、これが **標準モデル** を与えることが多い。

---

## **5. まとめ**
- **標準因子 \( K_C \) とは？**
  - 曲線上の正則微分 \( \omega \) の極を記録する因子。
  - 標準線束 \( \mathcal{O}(K_C) \) に対応する。
  
- **標準因子の次数**
  - \( \deg K_C = 2g - 2 \) という公式が成り立つ。
  
- **標準因子の具体例**
  - \( \mathbb{P}^1 \) の場合：\( K_{\mathbb{P}^1} = -2P \)
  - 楕円曲線：\( K_C = 0 \)
  - 種数 2 の曲線：\( \deg K_C = 2 \)

- **標準因子の応用**
  - 種数の計算
  - 標準束とリーマン・ロッホの定理
  - 標準写像による曲線の射影埋め込み

標準因子を用いることで、曲線の基本的な性質を統一的に理解できる。

---
---
