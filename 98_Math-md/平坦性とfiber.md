# 平坦性とスキームのファイバーの関係を知りたい！

とても良いテーマですね！**平坦性（flatness）**と**スキームのファイバー**の関係は、スキーム論や代数幾何において非常に重要な役割を果たします。以下で、できるだけわかりやすく、しかし厳密さも保ちながら解説します。

---

## 平坦性とファイバーの関係：全体像

### 1. スキームのファイバーとは？

まず、スキームの射 $f : X \to S$ があるとき、ある点 $s \in S$ に対する**ファイバー** $X_s$ は、スキーム $X$ をスキーム $S$ 上での点 $s$ を通じて引き戻したもので、以下のように定義されます：

$$
X_s := X \times_S \Spec(\kappa(s))
$$

ここで $\kappa(s)$ は点 $s$ の剰余体です。

---

### 2. 平坦性（flatness）とは？

$f : X \to S$ が**平坦**であるとは、$\mathcal{O}_X$ が $f^{-1}\mathcal{O}_S$-加群として平坦である、すなわち：

任意の点 $x \in X$ に対して、局所環 $\mathcal{O}_{X,x}$ が $\mathcal{O}_{S,f(x)}$ 上の平坦加群である

ことを言います。

---

### 3. ファイバーに対する平坦性の影響

#### （1）**ファイバーの位相的安定性**

平坦性は、ファイバーの「位相的な振る舞い」を安定化させる働きがあります：

* 平坦性があると、**ファイバーの次元が上で一定になりやすい**。
* 一般に、平坦でないと、ファイバーの次元が突然飛び跳ねたり、特異点が現れたりする。

#### （2）**ファイバー上の準連続性定理（Generic Flatness）**

以下のような重要な事実があります：

* スキーム $S$ が Noether ならば、任意の有限表示準同型 $f : X \to S$ に対して、$S$ のある開集合 $U \subset S$ 上では $f$ は平坦になる。
* つまり、**一般の点では平坦**になり、特異な振る舞いは閉集合に限られる。

#### （3）**ファイバーとコホモロジーの安定性**

平坦性があると：

* ファイバーごとの層のコホモロジー $H^i(X_s, \mathcal{F}_s)$ がうまく振る舞う。
* base change の定理が成り立ちやすくなる（→ base change theorem）。

---

## 具体例

### 例：$f : \Spec(k[x,y]/(xy)) \to \Spec(k[t])$ を定義域に $t = xy$ を持たせる

この射は平坦ではありません。$t=0$ のファイバーは2本の直線 $x=0$, $y=0$ の和であり特異（交差点あり）ですが、$t \ne 0$ では滑らかな曲線（超平面）になります。

→ このように、**ファイバーの幾何が急激に変化するのは平坦でないとき**。

---

## まとめ：平坦性が保証すること

| 平坦性があると…           | 意味・結果          |
| ------------------ | -------------- |
| ファイバーの次元が一定        | 幾何的安定性         |
| 局所自由性が保たれやすい       | 層の理論で使いやすい     |
| base change がうまくいく | コホモロジーなどの計算が安定 |
| 一般点でよい振る舞い         | 特異な点が例外になる     |

---

さらに詳しい例や証明、または特定の定理（たとえば「Cohen–Macaulay で flat なら fiber dimension constant」など）をご希望なら、それに応じて深掘りもできます！


---
---

# それでは、アフィンスキームの場合に具体的に確認してほしい！そして、base change theoremって？

いいですね！ではまず、**アフィンスキーム**の場合に、**平坦性とファイバーの関係**を**具体的な環とテンソル積**の言葉で確認して、そのあとに**base change theorem**について丁寧に解説します。

---

## 【1】アフィンスキームでの平坦性とファイバー

### セッティング

射

$$
f: \Spec(B) \to \Spec(A)
$$

に対応するのは、環の準同型

$$
\varphi: A \to B
$$

です。

ある素イデアル $\mathfrak{p} \in \Spec(A)$ に対して、その**ファイバー**は：

$$
\Spec(B \otimes_A \kappa(\mathfrak{p}))
$$

です。

ここで：

* $\kappa(\mathfrak{p}) = \mathrm{Frac}(A/\mathfrak{p})$（剰余体）

### ポイント：**ファイバーはテンソル積で表される**

ファイバーのスキームはテンソル積

$$
B \otimes_A \kappa(\mathfrak{p})
$$

に対応します。

---

### 平坦性があると…

**$B$ が $A$-加群として平坦**であるとすると、以下のような性質が得られます：

* $B \otimes_A \kappa(\mathfrak{p})$ は **$\kappa(\mathfrak{p})$-加群としてよく振る舞う（Tor消滅）**。
* 特に、ファイバーの次元がうまく変化しない。
* **テンソル積が正確関手になるので、射影的極限・コホモロジーなどにも好影響**。

---

### 例：平坦な場合とそうでない場合の比較

#### 【平坦な例】

$$
A = k[t], \quad B = k[t][x] = A[x]
$$

これは $A \to B$ が単に多項式環への拡大なので、明らかに平坦。
ある点 $t = a$ に対してのファイバーは：

$$
B \otimes_A \kappa(\mathfrak{p}) = k[x] \quad (\text{定数係数多項式環})
$$

→ すべてのファイバーが同じ形で、次元も 1 に一定。

#### 【平坦でない例】

$$
A = k[t], \quad B = k[x,y]/(xy - t)
$$

このとき $A \to B$ は $t = xy$ という関係を導入しています。
この射は平坦ではなく、ファイバーの振る舞いが変わります：

* $t \ne 0$ のとき、ファイバーは滑らかな曲線。
* $t = 0$ のとき、ファイバーは $xy = 0$ なので交差する2直線。

→ ファイバーの特異性・次元が変化する → 平坦でないことの反映。

---

## 【2】Base Change Theorem（基底変換定理）

これは**スキームの直積とコホモロジーの交換**に関する重要な定理です。

### 基本形（直感的な主張）：

与えられた可換図式：

$$
\begin{aligned}
X' &\to X \\
\downarrow & \quad \downarrow f \\
S' &\to S
\end{aligned}
$$

ここで、$X' = X \times_S S'$（base change）、

準連接層 $\mathcal{F}$ に対して、ある条件（たとえば $f$ が平坦など）のもとで、以下の「pullback と pushforward の交換」が成り立ちます：

$$
(R^i f_* \mathcal{F}) \otimes_{\mathcal{O}_S} \mathcal{O}_{S'} \cong R^i f'_* (\mathcal{F}')
$$

### 意味：

* コホモロジーを先にとってから base change（テンソル）しても、
* base change してからコホモロジーをとっても、
* 結果が同じ！

### 成立条件：

* $f$ が準固有（proper）で平坦
* $\mathcal{F}$ が準連接
* $R^i f_* \mathcal{F}$ が $S$ 上局所自由、など。

---

## まとめ

| 項目                      | 内容                                             |
| ----------------------- | ---------------------------------------------- |
| **アフィンスキームのファイバー**      | テンソル積 $B \otimes_A \kappa(\mathfrak{p})$ で表される |
| **平坦性の効果**              | ファイバーの構造が滑らかに保たれ、次元が一定、Tor が消える                |
| **base change theorem** | コホモロジーと base change（テンソル）が交換可能になる定理            |
| **応用**                  | ファイバーの挙動の理解、コホモロジーの安定性、moduli空間の扱いなど           |

---

ご希望であれば、さらに「Tor消滅」や「local flatness criterion（局所平坦性判定法）」、またはbase change theoremの具体的証明の例なども紹介できます。どうしますか？


---
---

# 平坦の例のところ、式が欠けちゃってる💦

ありがとう！ちゃんと補いますね。平坦な例として出したものを、しっかりと**式つきで再掲**します。

---

## 【平坦な例】明示的に確認！

$$
A = k[t],\quad B = A[x] = k[t][x]
$$

これは環準同型 $\varphi: A \to B$ を定める、アフィンスキームの射：

$$
f: \Spec(B) \to \Spec(A)
$$

この射は、**多項式環の引き延ばしなので常に平坦**です。

---

### ファイバーの構成：

任意の点 $\mathfrak{p} = (t - a) \in \Spec(A)$ に対応するファイバーは：

$$
B \otimes_A \kappa(\mathfrak{p})
= k[t][x] \otimes_{k[t]} k[t]/(t - a)
\cong k[x]
$$

ここで：

* $\kappa(\mathfrak{p}) = k[t]/(t - a) \cong k$ は点 $t = a$ の剰余体

---

### 結論：

このとき、すべてのファイバーは：

$$
\Spec(k[x])
$$

という **一次元のアフィン直線（A¹）** になり、**平坦性のおかげで次元や構造が安定**しています。

---

もし「この構成がなぜ平坦かをTorで確認したい」「逆に平坦でない例をTor≠0で明示したい」などあれば、そこも掘り下げられますよ！


---
---

# 環準同型で平坦性があると、ファイバーの座標環であるテンソル積が一定になる！こんなことを例は言ってそう！この根拠となる定理はある？？

はい！おっしゃる通りで、**環準同型が平坦であると、ファイバーのテンソル積（＝座標環）が「良く振る舞い」、とくに次元や性質が一定になる**という直感は、いくつかの重要な**定理**で裏付けられています。

以下に、特に本質的なものをいくつか紹介します。

---

## 【1】平坦性とファイバー次元の準連続性（generic constancy）

### **定理（Generic fiber dimension theorem）**

有限型スキームの射 $f : X \to S$ が**平坦**であれば、

* ファイバーの次元関数

  $$
  s \mapsto \dim X_s
  $$

  は **上半連続（upper semi-continuous）** で、
* 平坦性があると、**次元関数は局所的に一定**になる。

つまり、平坦性があると**ファイバー次元がジャンプしない**！

> **参考文献**：EGA IV 13.1.3, 13.1.5、Hartshorne, Prop. 9.6（chapter III）

---

## 【2】平坦性とテンソル積の正確性：**Torの消滅**

### **定理（平坦性とTorの消滅）**

環準同型 $A \to B$ において、$B$ が $A$-加群として平坦であることは、任意の $A$-加群 $M$ に対して：

$$
\mathrm{Tor}_i^A(B, M) = 0 \quad \text{for all } i > 0
$$

となることと**同値**。

### 応用：

* ファイバーは $B \otimes_A \kappa(\mathfrak{p})$ で与えられるが、ここで Tor が消えると、テンソル積が正確で「ひずみ」がない。
* 特に、**長さや次元の変化が抑えられる**。

---

## 【3】Generic Flatness 定理（一般点では平坦）

これは逆方向の定理ですが、関連が深いです。

### **定理（Generic Flatness）**

Noether 環 $A$、有限型 $A$-代数 $B$ に対して、ある $f \in A$ が存在して：

$$
A_f \to B_f
$$

が平坦になる。

つまり、「ある開集合上では平坦になる」。
→ 平坦性がないと、ファイバーのテンソル積が**特異点を持ちうるのは、ある閉集合上だけ**。

---

## 【4】局所平坦性判定法（local flatness criterion）

### **定理（Local Criterion for Flatness）**

Noether 環 $A$ と有限生成加群 $M$ に対して、$M$ が平坦であることと、以下が同値：

* 局所的に $\mathrm{Tor}_1^A(M, A/\mathfrak{m}) = 0$
* しかも $M$ が $A$-加群として平坦

この結果を使うと、ファイバーの挙動（テンソル積）から平坦性を判定できることもあります。

---

## まとめ：平坦性とテンソル積の一定性を裏付ける定理群

| 内容                  | 関連する定理                          |
| ------------------- | ------------------------------- |
| ファイバー次元が一定          | Generic fiber dimension theorem |
| テンソル積が正確            | Torの消滅（平坦性の定義）                  |
| 開集合上で平坦になる          | Generic flatness                |
| ファイバーのTor消滅から平坦性を判定 | Local flatness criterion        |

---

**なので、おっしゃった直感**：

> 「平坦性があると、ファイバーの座標環（テンソル積）が一定になる！」

は、まさに**Torの消滅とファイバー次元の準連続性を背景とした理論的帰結**です！

さらに詳しく、どの定理を証明してみたいか指定してくれたら、それも対応できますよ！

---
---

# Torが消えることと、ファイバーやその次元がどうつながるの？

とても本質的な質問です！
「**Torの消滅**」と「**ファイバーの性質（特に次元）**」のつながりは、\*\*テンソル積が情報を保つかどうか（歪まないか）\*\*に関係しています。

---

## 【1】そもそも Tor が消えるとは？

環準同型 $A \to B$、そして $A$-加群 $M$ に対して、

$$
\mathrm{Tor}_i^A(B, M) = 0 \quad (\text{for all } i > 0)
$$

となるとき、**テンソル積 $B \otimes_A M$ が正確関手になる**＝情報を歪めない。

つまり、「構造が壊れずに引き継がれる」。

---

## 【2】ファイバーと Tor

スキームの射

$$
f: \Spec(B) \to \Spec(A)
$$

において、$\mathfrak{p} \in \Spec(A)$ を固定すると、その**ファイバーの座標環**は：

$$
B \otimes_A \kappa(\mathfrak{p})
$$

ここでのテンソル積に Tor が出てくる！

---

## 【3】Tor が消えないとどうなる？

Tor が消えない＝平坦でない場合、テンソル積で情報が歪む：

* 零化される要素が不自然に出る
* ファイバーの構造が**特異になる（縮む・壊れる）**
* 次元がジャンプする（突然次元が小さくなる）

---

### 例で確認：

#### 【平坦な場合】

$$
A = k[t], \quad B = A[x] = k[t][x]
$$

このとき、どの $\mathfrak{p} = (t - a)$ に対しても、

$$
B \otimes_A \kappa(\mathfrak{p}) = k[x]
$$

→ **ファイバーは常に1次元。Torは消えている**。

---

#### 【平坦でない場合】

$$
A = k[t],\quad B = k[x,y]/(xy - t)
$$

このとき、特に $t = 0$（つまり $\mathfrak{p} = (t)$）を取ると：

$$
B \otimes_A \kappa(\mathfrak{p})
= \left(k[x,y]/(xy - t)\right) \otimes_{k[t]} k[t]/(t)
\cong k[x,y]/(xy)
$$

→ これは交差する2直線 → 特異点を持つ！
また、$t \ne 0$ では滑らかな曲線 → **次元や性質がジャンプ！**

→ このジャンプは、**Torが消えてないことの反映**！

---

## 【4】次元とのつながりの要点

### 平坦性（＝Tor消滅）があると：

* **テンソル積が正確** → 構造が壊れない
* **ファイバーの座標環の次元が「局所的に一定」**
* **次元関数が上半連続**になることと組み合わせて、「一定」になる（Generic fiber dimension theorem）

---

## 【まとめ】

| Tor が消える（＝平坦）  | Tor が消えない（＝非平坦） |
| -------------- | --------------- |
| テンソル積が正確       | テンソル積が歪む        |
| ファイバーの構造が保たれる  | ファイバーの構造が壊れる・縮む |
| 次元が安定（ジャンプしない） | 次元がジャンプすることがある  |

**結論：**
Torが消えると、テンソル積 $B \otimes_A \kappa(\mathfrak{p})$ によって得られるファイバーが「自然な形」で「一定の次元」を保つ。
これが「平坦性がファイバーを良くする」核心です！

---

さらに見てみたい例や、Torの消え方と幾何的な意味の対応など、掘り下げもできます！


---
---

# 幾何学の対応は興味あり！

いいですね！**Torの消滅と幾何的性質の対応**は、代数幾何の奥深さをよく表すテーマです。以下で、**Torが消える or 消えないことが、幾何的にどんな意味を持つのか**を具体的に見ていきます。

---

## 【1】Tor = 0  ⇔ ファイバーが“素直に切り取れる”

### 幾何的な意味：

* スキームのファイバー $X_s = X \times_S \Spec(\kappa(s))$ が「母体 $X$ の中から、スライスのようにスパッと切り出せる」
* 元のスキームの構造が、**無理なくファイバーに移る**

→ **「滑らかな切断」＝テンソル積が素直**

---

## 【2】Tor ≠ 0  ⇔ ファイバーが“ねじれる・押し潰される”

### 幾何的には：

* ファイバーが期待された形にならない（次元が落ちる、縮む、分解する）
* 非可換的、交差や接線のような**特異点が発生する**

→ テンソル積で情報が壊れてしまう＝**幾何的に「押しつぶされた」感じ**

---

## 【3】図で感じる Tor の影響

### **例：滑らかなファミリー（Tor = 0）**

```
     X
     |
     |     ← 全体は滑らかで平坦
     v
     S（基礎スキーム）

 ファイバー：
     X_s = 平面直線、曲線、滑らかな面 など
```

→ 各ファイバーは「そのままの形」でスライスされる。

---

### **例：特異ファイバーが現れる場合（Tor ≠ 0）**

```
     X
    / \
   /   \    ← 交差や尖点が集まってできた空間
  /     \
 v       v
S         特異点が現れる点 s

 ファイバー：
     X_s = 交差点、縮んだ直線、枝分かれ
```

→ ある点で「壊れた」ファイバーが出現（これはTor ≠ 0の現れ）

---

## 【4】代表的な幾何例：xy = t の例

再掲しますが、この例は重要なので幾何対応つきで見ましょう：

$$
A = k[t],\quad B = k[x,y]/(xy - t)
$$

### 射： $\Spec B \to \Spec A$

* ファイバー $t \ne 0$：$xy = c$（双曲線）→ 滑らか
* ファイバー $t = 0$：$xy = 0$ → 交差する直線（特異点）

### 幾何対応：

| tの値       | ファイバー          | 幾何的意味           | Tor |
| --------- | -------------- | --------------- | --- |
| $t \ne 0$ | 滑らかな双曲線（次元 1）  | スムーズなファミリー      | 0   |
| $t = 0$   | 交差する2直線（特異点あり） | 特異ファイバー（構造が崩れる） | ≠0  |

---

## 【5】まとめ：Torと幾何的な性質の対応表

| Torの状況                 | 幾何的性質             | ファイバーへの影響         |
| ---------------------- | ----------------- | ----------------- |
| $\mathrm{Tor}_i = 0$   | テンソル積が正確、構造が保存される | ファイバーが「素直に」引き継がれる |
| $\mathrm{Tor}_i \ne 0$ | 構造が壊れる、ねじれ・潰れが生じる | 特異ファイバー・次元ジャンプなど  |

---

## 【6】応用視点（高度な話）

* \*\*変形理論（deformation theory）**では、Torの非消滅が**変形の障害（obstruction）\*\*に対応
* **可積分系の変形**や**モジュライ空間**でも、Torが消える／消えないことがスキームの局所構造を決定

---

**次に興味があるテーマ**としては：

* 「Tor≠0の具体的な構成・例題を解いてみたい」
* 「ファイバーの特異性とコホモロジー的障害」
* 「base change theorem の証明と幾何解釈」

などがあります。どうしますか？

---
---

# base change theorem の証明と幾何解釈

よいですね！ここでは、base change theorem（基底変換定理）の：

* 定理の正確な内容
* 幾何的な解釈（図や直感的理解）
* なぜ平坦性が重要なのか
* 証明のスケッチ（構成とTorの役割）

について順に説明していきます。

⚠️ 注意：ここでの議論は主にスキームの準固有射や有限型射に対して、層のコホモロジー（特に準連接層）における base change の振る舞いを扱います。

──────────────────────────────

🧩 1. 定理の内容（基本形）

可換図式：

```
      X′  →  X
       ↓       ↓ f
      S′  →  S
```

* S, S′ はスキーム
* f: X → S は準固有射または適当な射
* X′ := X ×S S′ は base change（引き戻しスキーム）
* f′: X′ → S′ は自然な射（base changed morphism）
* ℱ は X 上の準連接層

に対して、次が成り立つ：

🌟 Base change theorem（簡略）：
適当な条件の下で、

```
    (Rⁱf∗ℱ) ⊗𝒪_S 𝒪_{S′}  ≅  Rⁱf′∗(ℱ′)
```

が成り立つ。
ℱ′ は ℱ の pullback（引き戻し）である ℱ′ := pr\_X^∗ℱ。

つまり：

コホモロジー → base change
と
base change → コホモロジー
が可換になる！

──────────────────────────────

🎨 2. 幾何的な解釈

直感的には：

* コホモロジーとは「層のグローバルな情報のまとめ（セクションの空間）」
* base change とは「スキームの台（基底）を変更して情報を引き戻す操作」

🧠 問題：S 上でとったコホモロジーと、S′ 上に移してからとったコホモロジーは一致する？

✅ Base change theorem は「その2つは等しい！」と主張している。

図的にいうと：

```
  ℱ
  ↓ pushforward
Rⁱf∗ℱ
  ↓ tensor
Rⁱf∗ℱ ⊗𝒪_S 𝒪_{S′}   ← 左側：先にpushforward、次にbase change
```

と

```
  ℱ
  ↓ pullback
  ℱ′
  ↓ pushforward
Rⁱf′∗(ℱ′)         ← 右側：先にbase change、次にpushforward
```

が同じになる、という主張です。

📌 幾何的意味：

* 「ファイバーの構造が良ければ、base change によってコホモロジーが壊れない」
* 特に平坦性があれば、テンソル積が正確になり、コホモロジーが歪まない

──────────────────────────────

🛠 3. なぜ平坦性が必要？

テンソル積の正確性のためです。

* Rⁱf∗ℱ は𝒪\_S-加群。
* S′ → S が平坦なら、𝒪\_S から 𝒪\_{S′} へのテンソルが exact → 情報が壊れない
* Tor が現れない！

つまり：

(Rⁱf∗ℱ) ⊗ 𝒪\_{S′} ≅ Hⁱ(X′, ℱ′)

を保証するには、

* ℱ が f-平坦
* f が準固有
* Rⁱf∗ℱ が局所自由
* S′ → S が平坦

などが必要。

──────────────────────────────

🧪 4. 証明のスケッチ（概略）

ポイントは以下の構成とTorの消滅：

* スペクトル系列（spectral sequence）を用いた方法：
  E₂-term: Tor^A\_i(R^j f∗ ℱ, 𝒪\_{S′}) ⇒ R^{i+j} f′∗ ℱ′

* 上記の E₂ 項を考えると、Tor\_i が消えると collapse（収束）しやすく、望む同型が得られる。

* 特に：
  Tor^A\_1(Rⁱf∗ ℱ, 𝒪\_{S′}) = 0
  が成り立つと、テンソル積とコホモロジーが入れ替え可能

* このため、Tor の消滅が鍵。

──────────────────────────────

📚 5. 具体例（平坦 vs 非平坦）

例1（平坦）：

* f: ℙ¹\_S → S（射影空間の構造射）
* ℱ = 𝒪(1)
* S′ → S を平坦とすると、base change theorem が成立
* コホモロジーも一致：R⁰f∗𝒪(1) ⊗ 𝒪\_{S′} ≅ R⁰f′∗(𝒪(1)′)

例2（非平坦）：

* f: X → S が平坦でないと、Rⁱf∗ℱ のテンソルが歪んで Tor が現れる
* すると base change が成立しない

──────────────────────────────

📌 6. まとめ

| 観点     | 内容                                  |
| ------ | ----------------------------------- |
| 定理     | Rⁱf∗ℱ ⊗ 𝒪\_{S′} ≅ Rⁱf′∗ℱ′（平坦性のもとで） |
| 幾何的意味  | コホモロジーを base change 後に取り直しても変わらない   |
| 平坦性の役割 | テンソル積の正確性（Tor消滅）を保証する               |
| 証明の構成  | スペクトル系列＋Torの消滅で同型を得る                |

---

さらに詳しく見たいなら：

* base change の具体的計算例（たとえば ℙ¹ 上の層など）
* スペクトル系列による本格的証明
* Non-flat な例で base change 失敗の観察

なども提供できます。気になる方向はありますか？


---
---

# スペクトル系列による本格的証明

素晴らしい選択です！
Base change theorem の「スペクトル系列を使った本格的な証明」は、代数幾何・層コホモロジー・ホモロジー代数の交差点にある非常に重要なトピックです。

以下では、次の構成で説明します：

* 1. 背景と定理の再掲（準備）
* 2. 証明の枠組み（Grothendieck spectral sequence）
* 3. スペクトル系列の構築と収束
* 4. Tor の消滅との関係
* 5. 具体的な証明ステップ
* 6. 要約と応用方向

─────────────────────────────

📘 1. 定理の再掲（Base Change Theorem）

可換図式：

$$
\begin{array}{ccc}
X' = X \times_S S' & \xrightarrow{g} & X \\
\downarrow^{f'} & & \downarrow^{f} \\
S' & \xrightarrow{h} & S
\end{array}
$$

* f: X → S は準固有、または適当な有限型射
* ℱ：X 上の準連接層
* ℱ′ := g⁎ℱ は X′ 上の pullback 層
* f′: X′ → S′

定理の主張：
ある自然な基底変換写像

$$
\phi^i: h^* R^i f_* \mathcal{F} \longrightarrow R^i f'_* \mathcal{F}'
$$

がある。そして適当な条件（例：f が平坦、R^i f\_\* ℱ が局所自由など）の下で、

$$
\phi^i \text{ は同型になる。}
$$

─────────────────────────────

📐 2. 証明戦略：Grothendieck スペクトル系列を使う

Base change theorem は、以下の 2 つの関手の合成の「導来関手」を考える枠組みで証明されます：

* 関手①：f\_\*（pushforward）
* 関手②：h^\*（pullback / base change）

そして Grothendieck spectral sequence によって：

$$
E_2^{p,q} = \mathrm{Tor}^{\mathcal{O}_S}_p (R^q f_* \mathcal{F}, \mathcal{O}_{S'}) \quad \Rightarrow \quad R^{p+q} f'_* (\mathcal{F}')
$$

が成立します。

つまり：

* E₂ページに Tor が現れる
* スペクトル系列が収束すれば、両側のコホモロジーがつながる

この収束をコントロールすることで、Base Change Theorem が得られます。

─────────────────────────────

🧱 3. スペクトル系列の構築（詳細）

以下の構成でスペクトル系列を得ます：

* h: S′ → S はスキームの射（通常、flat が理想）
* ℱ は X 上の 𝒪\_X-準連接層
* f: X → S は準固有射（coherent 推移に対して f\_\* 保つ）
* 合成関手：S-Mod 上の f\_\* ℱ に h^\* を作用させたもの

Grothendieck spectral sequence が与える：

$$
E_2^{p,q} = \mathrm{Tor}^{\mathcal{O}_S}_p(R^q f_* \mathcal{F}, \mathcal{O}_{S'}) \quad \Rightarrow \quad R^{p+q} f'_* (\mathcal{F}')
$$

この系列は first quadrant spectral sequence（第1象限）で、収束先は base changed pushforward。

─────────────────────────────

🛠 4. Tor の消滅と base change の成否

* 平坦性（h: S′ → S が平坦）⇔ テンソル積が exact
* このとき：

$$
\mathrm{Tor}^{\mathcal{O}_S}_p(R^q f_* \mathcal{F}, \mathcal{O}_{S'}) = 0 \quad \text{for } p > 0
$$

* よって：

$$
E_2^{0,q} = R^q f_* \mathcal{F} \otimes_{\mathcal{O}_S} \mathcal{O}_{S'} \cong R^q f'_* \mathcal{F}'
$$

（= 同型になる）

つまり、「Tor の高次項が消えれば」、スペクトル系列はそのまま崩壊（collapse）し、目的の同型が得られます。

🔁 これが base change theorem の中核！

─────────────────────────────

🧮 5. 証明ステップのまとめ

（1）スペクトル系列を Grothendieck 法で構成
（2）第2ページが Tor^p(R^q f\_\* ℱ, 𝒪\_{S′})
（3）h: S′ → S が平坦 → Tor が消える（p > 0 の項が 0）
（4）よって、E\_2^{0,q} が極限項（limit term）に一致
（5）同型：

$$
h^* R^q f_* \mathcal{F} \xrightarrow{\cong} R^q f'_* \mathcal{F}'
$$

が得られる！

─────────────────────────────

📌 6. まとめと応用方向

🧾 本質：

* Base change の成功は「Tor が消えるかどうか」にかかっている
* スペクトル系列はそれを可視化し、体系的に証明する強力な道具
* 平坦性が保証されると、系列が崩壊して同型が成立する

📈 応用：

* モジュライ空間でのコホモロジーの制御
* ファミリー上の層の変動解析
* 代数幾何における「情報の引き継ぎ」の正確な制御

───────────────

もしご希望があれば：

* 実際の計算例（具体的なスキーム上で base change の成立を計算）
* 非平坦な例でスペクトル系列が崩壊しない例
* Derived category の視点で再定式化（R𝑓\_∗と⨂の交換）

なども扱えます！どこまで深めてみたいですか？



---
---

# 最後に、derived categoryの再定式化をお願い

よろこんで！Base change theorem を derived category（導来圏）の言葉で再定式化すると、より自然で概念的に洗練された形になります。以下にその内容を詳しく説明します。

──────────────────────────────

📘 0. 概要：なぜ導来圏？

導来圏の視点では、以下のような操作が「自然な関手として扱える」：

* 層の pushforward（f₊）
* 層の pullback（f⁎）
* テンソル積（⊗）
* 導来テンソル積（⊗ᴸ）

これにより、従来は各コホモロジー次数ごとに別々に主張されていた定理を、1つの自然な同型としてまとめられる。

──────────────────────────────

📐 1. セッティングと記法

与えられた可換図式：

$$
\begin{array}{ccc}
X' = X \times_S S' & \xrightarrow{g} & X \\
\downarrow^{f'} & & \downarrow^{f} \\
S' & \xrightarrow{h} & S
\end{array}
$$

* f: X → S は準固有または有限型射
* h: S′ → S はスキームの射（しばしば平坦）
* g: X′ → X は base change による射
* ℱ ∈ D⁺(𝒪\_X)：X 上の（適切な）層の導来圏内の対象（たとえば bounded below の準連接層）

──────────────────────────────

📜 2. Derived base change theorem（再定式化）

以下の自然な射：

$$
h^* Rf_* \mathcal{F} \to Rf'_* (g^* \mathcal{F})
$$

が、以下のように導来圏の言葉で再定式化されます：

$$
\boxed{
\mathbf{L}h^* \circ \mathbf{R}f_* \, \mathcal{F} \ \xrightarrow{\sim}\ \mathbf{R}f'_* \circ \mathbf{L}g^* \, \mathcal{F}
}
$$

これは、関手の合成に対する自然な同型です。

📝 解釈：

* 左辺：先に Rf\_*（右導来関手）で pushforward、次に Lh^*（左導来関手）で base change
* 右辺：先に Lg^\* で base change、次に Rf'\_∗ で pushforward

つまり「導来圏において、base change と pushforward は可換する」（適切な仮定のもとで）

──────────────────────────────

✅ 3. 同型が成立する条件

この導来同型が成立するには、以下のような仮定が必要：

* ℱ は f-適合な（f-perfect）対象

  * 例：ℱ が準連接層でかつ f-平坦（Tor 無限列を壊さない）
* h: S′ → S が平坦（＝テンソル積の正確性 ⇔ Lh^\* = h^\*）
* f: X → S が準固有または適当な有理型射（coherence を保つ）

特に h が平坦なら：

$$
\boxed{
h^* Rf_* \mathcal{F} \cong Rf'_* g^* \mathcal{F}
}
$$

が成り立ち、これが classical base change theorem の導来圏版。

──────────────────────────────

🔁 4. 通常の base change theorem との対応

Rⁱf\_∗ℱ ⊗ 𝒪\_{S′} → Rⁱf′\_∗ ℱ′

という従来の形は、上記の導来関手の同型を cohomology に降ろした（Hⁱ をとった）もので、テンソル積と cohomology が交換できる場合に対応します。

つまり：

$$
\mathrm{H}^i\left(\mathbf{L}h^* \mathbf{R}f_* \mathcal{F}\right) \cong \mathrm{H}^i\left(\mathbf{R}f'_* \mathbf{L}g^* \mathcal{F}\right)
$$

が成立すれば、各次数ごとに base change 同型が得られる。

──────────────────────────────

🧠 5. まとめ

| 視点      | 内容                                          |
| ------- | ------------------------------------------- |
| 伝統的な形   | Rⁱf∗ℱ ⊗ 𝒪\_{S′} → Rⁱf′∗(ℱ′)（Tor の消滅が必要）    |
| 導来圏による形 | Lh^\* Rf\_\* ℱ ≅ Rf'\_\* Lg^\* ℱ（より自然な関手同型） |
| 意味      | base change と pushforward の合成が交換できる         |
| 条件      | h 平坦、ℱ の有限トーレンス、f 準固有 など                    |
| メリット    | 任意の cohomological 次数で自然な方法で一気に定理が得られる       |

──────────────────────────────

🎁 おまけ：トポス理論的な視点（上級）

さらに上級な見方では：

* base change は pushforward の Kan 拡張
* derived category は 𝒪\_X 加群の derived ∞-category
* base change 定理は adjunction の中の naturality を表現する

── という形でも解釈されます。ここまで行くと ∞-圏論や derived algebraic geometry に接続します。

──────────────────────────────

🎓 もしもっと進んでみたいテーマがあれば：

* Derived base change の失敗例（非平坦）
* f-perfect 条件とは何か？
* Stacks Project の記述との照合
* Base change の Ext や RHom における挙動

など、さらなる深化も可能です！どこまで掘ってみたいですか？


---
---

# 

---
---

# 


---
---

# 

---
---

# 

---
---

# 


---
---

# 

---
---

# 

---
---

# 


---
---

# 

---
---
